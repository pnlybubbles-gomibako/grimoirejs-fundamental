!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=115)}([function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Node.Component},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(56),l=r(s),c=n(14),f=r(c),d=n(49),h=r(d),p=n(3),_=r(p),v=n(57),y=r(v),b=n(65),m=r(b),g=n(37),w=r(g),E=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},R=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.gl=e,n.shaderHeader=t.defaultShaderHeader,n.macro=new m.default,n}return a(t,e),u(t,[{key:"instanciate",value:function(e){return E(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.materialGeneratorResolver.get(e);case 2:return r=n.sent,n.abrupt("return",r(this));case 4:case"end":return n.stop()}},n,this)}))}}],[{key:"get",value:function(e){return _.default.__get(e,t)}},{key:"addMaterialType",value:function(e,t){this.materialGeneratorResolver.register(e,Promise.resolve(t))}},{key:"addSORTMaterial",value:function(e,t){return E(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.materialGeneratorResolver.register(e,function(){return E(r,void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.default.parse(t);case 2:return n=e.sent,e.abrupt("return",function(e){return new w.default(e.gl,n)});case 4:case"end":return e.stop()}},e,this)}))}()));case 1:case"end":return n.stop()}},n,this)}))}},{key:"addSORTMaterialFromURL",value:function(e,t){var n=this;return this.materialGeneratorResolver.register(e,function(){return E(n,void 0,void 0,regeneratorRuntime.mark(function e(){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.default.resolve(t);case 2:return n=e.sent,e.next=5,y.default.parse(n);case 5:return r=e.sent,e.abrupt("return",function(e){return new w.default(e.gl,r)});case 7:case"end":return e.stop()}},e,this)}))}())}},{key:"getMaterialStatus",value:function(e){return this.materialGeneratorResolver.getStatus(e)}}]),t}(_.default);t.default=R,R.registryName="MaterialFactory",R.defaultShaderHeader=l.default,R.materialGeneratorResolver=new f.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(38),l=r(s),c=n(83),f=r(c),d=n(6),h=r(d),p=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,WebGLRenderingContext.TEXTURE_2D));return t.maxTextureSize||(t.maxTextureSize=e.getParameter(WebGLRenderingContext.MAX_TEXTURE_SIZE)),n}return a(t,e),u(t,[{key:"update",value:function(e,t,n,r,o,i,a,u){this.gl.bindTexture(WebGLRenderingContext.TEXTURE_2D,this.resourceReference);var s=void 0,l=void 0,c=void 0,f=void 0;if(void 0===n?(s=Object.assign({flipY:!0,premultipliedAlpha:!1},t),l=e):(f=e,c=t,s=Object.assign({flipY:!0,premultipliedAlpha:!1},u)),this.gl.pixelStorei(WebGLRenderingContext.UNPACK_FLIP_Y_WEBGL,s.flipY?1:0),this.gl.pixelStorei(WebGLRenderingContext.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultipliedAlpha?1:0),void 0===n){var d=this.__ensurePOT(l);this._width=d.width,this._height=d.height,this.gl.texImage2D(this.textureType,0,WebGLRenderingContext.RGBA,WebGLRenderingContext.RGBA,WebGLRenderingContext.UNSIGNED_BYTE,d.result),this.__type=WebGLRenderingContext.UNSIGNED_BYTE,this.__format=WebGLRenderingContext.RGBA}else void 0===a&&(a=null),0!==c&&0!==n||(c=1,n=1,o=WebGLRenderingContext.RGB,i=WebGLRenderingContext.UNSIGNED_BYTE,a=new Uint8Array([0,0,0])),this._width=c,this._height=n,this.gl.texImage2D(this.textureType,f,o,c,n,r,o,i,a),this.__format=o,this.__type=i;this.__ensureMipmap(),this.valid=!0}},{key:"updateDrawerCanvas",value:function(){for(var e=this.drawerContext.createImageData(this.width,this.height),t=this.getRawPixels(),n=this.width*this.height*l.default.formatToElementCount(this.format),r=0;r<n;r++)e.data[r]=t[r];this.drawerContext.putImageData(e,0,0),this.drawerContext.setTransform(1,0,0,-1,0,this.height),this.drawerContext.drawImage(this.drawerContext.canvas,0,0)}},{key:"getRawPixels",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.width,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.height;return this.__getRawPixels(this.type,this.format,e,t,n,r,WebGLRenderingContext.TEXTURE_2D)}},{key:"applyDraw",value:function(){this._drawerContext&&this.update(this._drawerContext.canvas)}},{key:"__ensureMipmap",value:function(){this.__needMipmap(this.minFilter)&&(this.gl.bindTexture(WebGLRenderingContext.TEXTURE_2D,this.resourceReference),this.gl.generateMipmap(WebGLRenderingContext.TEXTURE_2D))}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"viewport",get:function(){return new h.default(0,0,this.width,this.height)}},{key:"drawerContext",get:function(){if(!this._drawerContext){var e=document.createElement("canvas");e.width=this._width,e.height=this.height,this._drawerContext=e.getContext("2d"),this.updateDrawerCanvas()}return this._drawerContext}}],[{key:"generateDefaultTexture",value:function(e){t.defaultTextures.set(e,null);var n=new t(e);n.update(0,1,1,0,WebGLRenderingContext.RGBA,WebGLRenderingContext.UNSIGNED_BYTE,new Uint8Array([0,0,0,0])),t.defaultTextures.set(e,n)}}]),t}(f.default);t.default=p,p.defaultTextures=new Map},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){r(this,e)}return o(e,null,[{key:"__get",value:function(t,n){var r=t;if(void 0===r.__id__)throw new Error("Supplied gl context seems not initialized by Grimoire.js");if(void 0===e._glRelatedRegistry[r.__id__]&&(e._glRelatedRegistry[r.__id__]={}),void 0!==e._glRelatedRegistry[r.__id__][n.registryName])return e._glRelatedRegistry[r.__id__][n.registryName];var o=new n(r);return e._glRelatedRegistry[r.__id__][n.registryName]=o,o}},{key:"__getAll",value:function(t){var n=[];for(var r in e._glRelatedRegistry){var o=e._glRelatedRegistry[r];void 0!==o[t.registryName]&&n.push(o[t.registryName])}return n}}]),e}();t.default=i,i._glRelatedRegistry={}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(5),a=function(e){return e&&e.__esModule?e:{default:e}}(i),u=function(){function e(t,n){if(r(this,e),this.gl=t,this.resourceReference=n,this.destroyed=!1,this._metadata={},!t)throw new Error("missing WebGLRenderingContext");this.index=e._maxIndex++,a.default.debug&&(n.__SPECTOR_Metadata=this._metadata,this.setMetadata("GL Resource Index",this.index)),this.valid=!1}return o(e,[{key:"setMetadata",value:function(e,t){this._metadata[e]=t}},{key:"destroy",value:function(){this.destroyed=!0}},{key:"valid",get:function(){return this._valid},set:function(e){var t=this;this._valid!==e&&(this._valid=e,this._valid?this._validResolve(this):this.validPromise=new Promise(function(e){t._validResolve=e}))}},{key:"metadata",get:function(){return this._metadata}}]),e}();u._maxIndex=0,t.default=u},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(84),s=function(e){return e&&e.__esModule?e:{default:e}}(u),l=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"configure",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e.viewport(0,0,this.Width,this.Height):e.viewport(this.Left,this.Bottom,this.Width,this.Height)}}]),t}(s.default);t.default=l},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS&&window.GrimoireJS.lib.math?window.GrimoireJS.lib.math.Vector3:void 0},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(36),l=r(s),c=n(17),f=r(c),d=n(7),h=r(d),p=n(18),_=r(p),v=n(0),y=r(v),b=l.default.mat4,m=l.default.vec3,g=l.default.vec4,w=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.localTransform=new f.default,e._children=[],e._cachePVM=new f.default,e._cacheVM=new f.default,e._forward=new h.default([0,0,-1,0]),e._up=new h.default([0,1,0,0]),e._right=new h.default([1,0,0,0]),e._globalPosition=new h.default([0,0,0]),e._globalScale=new h.default([1,1,1]),e._matrixTransformMode=!1,e._updatedTransform=!0,e._globalTransform=new f.default,e}return a(t,e),u(t,[{key:"calcPVM",value:function(e){return b.mul(this._cachePVM.rawElements,e.ProjectionViewMatrix.rawElements,this.globalTransform.rawElements),this._cachePVM}},{key:"calcVM",value:function(e){return b.mul(this._cacheVM.rawElements,e.ViewMatrix.rawElements,this.globalTransform.rawElements),this._cacheVM}},{key:"$awake",value:function(){var e=this;this.getAttributeRaw("position").watch(function(t){e.notifyUpdateTransform()}),this.getAttributeRaw("rotation").watch(function(t){e.notifyUpdateTransform()}),this.getAttributeRaw("scale").watch(function(t){e.notifyUpdateTransform()}),this.__bindAttributes()}},{key:"$mount",value:function(){this._parentTransform=this.node.parent.getComponent(t),this._parentTransform&&this._parentTransform._children.push(this),this._updateTransform()}},{key:"$unmount",value:function(){this._parentTransform&&(this._parentTransform._children.splice(this._parentTransform._children.indexOf(this),1),this._parentTransform=null)}},{key:"notifyUpdateTransform",value:function(){this._updatedTransform||(this._updatedTransform=!0,this._children.forEach(function(e){return e.notifyUpdateTransform()}))}},{key:"applyMatrix",value:function(e){this.setAttribute("scale",e.getScaling()),this.setAttribute("rotation",e.getRotation()),this.setAttribute("position",e.getTranslation())}},{key:"_updateTransform",value:function(e){this._updatedTransform&&(this._updatedTransform=!1,b.fromRotationTranslationScale(this.localTransform.rawElements,this.rotation.rawElements,this.position.rawElements,this.scale.rawElements),this._updateGlobalTransform(e))}},{key:"_updateGlobalTransform",value:function(e){this._parentTransform?b.mul(this._globalTransform.rawElements,this._parentTransform.globalTransform.rawElements,this.localTransform.rawElements):b.copy(this._globalTransform.rawElements,this.localTransform.rawElements),this._globalTransformInverse&&b.invert(this._globalTransformInverse.rawElements,this._globalTransform.rawElements),e||this._updateDirections(),this._updateGlobalProperty(),this.node.emit("transformUpdated",this)}},{key:"_updateDirections",value:function(){g.transformMat4(this._forward.rawElements,t._forwardBase.rawElements,this.globalTransform.rawElements),g.transformMat4(this._up.rawElements,t._upBase.rawElements,this.globalTransform.rawElements),g.transformMat4(this._right.rawElements,t._rightBase.rawElements,this.globalTransform.rawElements)}},{key:"_updateGlobalProperty",value:function(){this._parentTransform?(m.transformMat4(this._globalPosition.rawElements,this.position.rawElements,this._parentTransform.globalTransform.rawElements),m.transformMat4(this._globalScale.rawElements,this.scale.rawElements,this._parentTransform.globalTransform.rawElements)):(m.copy(this._globalPosition.rawElements,this.position.rawElements),m.copy(this._globalScale.rawElements,this.scale.rawElements))}},{key:"globalTransform",get:function(){return this._updateTransform(),this._globalTransform}},{key:"globalTransformInverse",get:function(){return this._globalTransformInverse?this._updateTransform():this._globalTransformInverse=f.default.inverse(this.globalTransform),this._globalTransformInverse}},{key:"globalPosition",get:function(){return this._updateTransform(),this._globalPosition}},{key:"globalScale",get:function(){return this._updateTransform(),this._globalScale}},{key:"forward",get:function(){return this._updateTransform(),this._forward}},{key:"up",get:function(){return this._updateTransform(),this._up}},{key:"right",get:function(){return this._updateTransform(),this._right}}]),t}(y.default);t.default=w,w.attributes={position:{converter:"Vector3",default:[0,0,0]},rotation:{converter:"Rotation3",default:[0,0,0,1]},scale:{converter:"Vector3",default:[1,1,1]}},w._forwardBase=new _.default(0,0,-1,0),w._upBase=new _.default(0,1,0,0),w._rightBase=new _.default(1,0,0,0)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){r(this,e)}return o(e,null,[{key:"calcHash",value:function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(69),u=r(a),s=n(7),l=r(s),c=n(70),f=r(c),d=n(20),h=r(d),p=n(9),_=r(p),v=function(){function e(t){o(this,e),this.gl=t,this.buffers=[],this.indices={},this.accessors={},this.aabb=new u.default([l.default.Zero]),this._accessorHashCache=0,h.default.request("ANGLE_instanced_arrays",!0),this.instanciator=h.default.get(t).extensions.ANGLE_instanced_arrays}return i(e,[{key:"addAttributes",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:WebGLRenderingContext.STATIC_DRAW,r=this.buffers.length,o=!1;for(var i in t){var a=t[i];if(a.bufferIndex=r,void 0===a.size)throw new Error('Accessor specified with the semantics "'+i+'" is not containing size as paranmeter.');void 0===a.type&&(a.type=WebGLRenderingContext.FLOAT),void 0===a.stride&&(a.stride=a.size*this._attribTypeToByteSize(a.type)),void 0===a.offset&&(a.offset=0),void 0===a.normalized&&(a.normalized=!1),void 0===a.keepOnBuffer&&(a.keepOnBuffer="POSITION"===i),o=o||!!a.keepOnBuffer,this.accessors[i]=a}e=this._ensureToBeVertexBuffer(e,n,o),this.buffers.push(e),this._recalculateAccsessorHash()}},{key:"addIndex",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments[6],u=void 0,s=void 0,l=void 0,c=void 0,d=void 0;if("number"==typeof t?(d=t,u=n,s=r,l=o,c=i,a||(a=0),"number"!=typeof l&&(l=0),"number"!=typeof s&&(s=WebGLRenderingContext.TRIANGLES)):(u=t,s=n,l=r,c=o,a=i,"number"!=typeof s&&(s=WebGLRenderingContext.TRIANGLES),"number"!=typeof l&&(l=0)),!c){if(u instanceof f.default||u instanceof ArrayBuffer||u instanceof DataView)throw new Error("The argument 'count' is necessary if you specified buffer with an instance of Buffer or ArrayBuffer");c=u.length}0===a&&(a=this._indexTypeFromCount(c)),u=this._ensureToBeIndexBuffer(u,a),this.indices[e]={byteOffset:l,byteSize:this._indexTypeToByteSize(a),type:a,topology:s,count:c,index:u,instanceCount:d}}},{key:"drawByDefault",value:function(t,n,r){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Number.MAX_VALUE,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;n.forEach(function(t){e.bindBufferToAttribute(o,r,t,t)}),e.drawWithCurrentVertexBuffer(this,t,i,a)}},{key:"clone",value:function(){var t=new e(this.gl);return t.buffers=[].concat(this.buffers),t.accessors=Object.assign({},this.accessors),t.indices=Object.assign({},this.indices),t.aabb=new u.default([this.aabb.pointLBF,this.aabb.pointRTN]),t}},{key:"_ensureToBeVertexBuffer",value:function(e,t,n){if(!(e instanceof f.default)){var r=e;Array.isArray(r)&&(r=new Float32Array(r)),e=new f.default(this.gl,WebGLRenderingContext.ARRAY_BUFFER,t),e.keepSource=n,e.update(r)}return e}},{key:"_ensureToBeIndexBuffer",value:function(e,t){if(e instanceof f.default){if(e.target!==WebGLRenderingContext.ELEMENT_ARRAY_BUFFER)throw new Error("The usage of buffer specified as index buffer is not ELEMENT_ARRAY_BUFFER")}else{var n=e;Array.isArray(n)&&(n=new(this._indexTypeToArrayConstructor(t))(n)),e=new f.default(this.gl,WebGLRenderingContext.ELEMENT_ARRAY_BUFFER,WebGLRenderingContext.STATIC_DRAW),e.update(n)}return e}},{key:"_indexTypeFromCount",value:function(e){if(e<256)return WebGLRenderingContext.UNSIGNED_BYTE;if(e<65536)return WebGLRenderingContext.UNSIGNED_SHORT;if(e<4294967296)return WebGLRenderingContext.UNSIGNED_INT;throw new Error("Index count exceeds 4,294,967,296. WebGL can not handle such a big index buffer")}},{key:"_indexTypeToArrayConstructor",value:function(e){switch(e){case WebGLRenderingContext.UNSIGNED_BYTE:return Uint8Array;case WebGLRenderingContext.UNSIGNED_SHORT:return Uint16Array;case WebGLRenderingContext.UNSIGNED_INT:return Uint32Array;default:throw new Error("Unsupported index type")}}},{key:"_indexTypeToByteSize",value:function(e){switch(e){case WebGLRenderingContext.UNSIGNED_BYTE:return 1;case WebGLRenderingContext.UNSIGNED_SHORT:return 2;case WebGLRenderingContext.UNSIGNED_INT:return 4;default:throw new Error("Unsupported index type")}}},{key:"_attribTypeToByteSize",value:function(e){switch(e){case WebGLRenderingContext.FLOAT:case WebGLRenderingContext.UNSIGNED_INT:return 4;case WebGLRenderingContext.UNSIGNED_SHORT:return 2;case WebGLRenderingContext.UNSIGNED_BYTE:return 1;default:throw new Error('Unsupported attribute variable type "'+e+'"')}}},{key:"_recalculateAccsessorHash",value:function(){var e="";for(var t in this.accessors)e+=t+"|";this._accessorHashCache=_.default.calcHash(e)}},{key:"accessorHash",get:function(){return this._accessorHashCache}}],[{key:"bindBufferToAttribute",value:function(e,t,n,r){var o=t.findAttributeLocation(n);if(o<0)return!1;var i=e.accessors[r];if(!i)throw new Error('Specified buffer "'+r+' was not found on this geometry while attempt to bind "'+n+'" of attribute variables.\n\n      All of the vertex buffer available on this geometry is '+Object.keys(e.accessors)+'"');return e.buffers[i.bufferIndex].bind(),t.gl.vertexAttribPointer(o,i.size,i.type,i.normalized,i.stride,i.offset),i.instancingDivisor>0&&e.instanciator.vertexAttribDivisorANGLE(o,i.instancingDivisor),!0}},{key:"drawWithCurrentVertexBuffer",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_VALUE,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e.indices[t];if(void 0===o)throw new Error('Specified index buffer "'+t+'" was not found on this geometry.All of the index buffer available on this geometry is "'+Object.keys(e.indices)+'"');o.index.bind(),o.instanceCount>0?e.instanciator.drawElementsInstancedANGLE(o.topology,Math.min(o.count,n),o.type,Math.min(r*o.byteSize+o.byteOffset,o.byteOffset+(o.count-1)*o.byteSize),o.instanceCount):o.index.gl.drawElements(o.topology,Math.min(o.count,n),o.type,Math.min(r*o.byteSize+o.byteOffset,o.byteOffset+(o.count-1)*o.byteSize))}}]),e}();t.default=v,v._lastGeometry=new Map},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.UniformResolverRegistry=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(82),a=function(e){return e&&e.__esModule?e:{default:e}}(i),u=t.UniformResolverRegistry=function(){function e(){r(this,e),this._generators={}}return o(e,[{key:"add",value:function(e,t){if("function"!=typeof t)throw new Error("secound argument of add must be function");this._generators[e.toUpperCase()]=t}},{key:"generateRegisterers",value:function(e,t){var n=[],r=[],o={};for(var i in t.uniforms){var u=t.uniforms[i],s=u.semantic,l=this._generators[s];if(!l)throw new Error("There was no suitable registerer for specified semantic "+s);var c=l(u,e,e.technique,e.material);"function"==typeof c?n.push(c):(n.push(c.register),c.dispose&&r.push(c.dispose),c.update&&(o[i]=c.update))}return new a.default(n,r,o)}}]),e}();t.default=new u},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=function(e){return e&&e.__esModule?e:{default:e}}(i),u=function(){function e(){r(this,e)}return o(e,null,[{key:"getPow2Size",value:function(e,t){var n=Math.pow(2,Math.ceil(Math.log2(e))),r=Math.pow(2,Math.ceil(Math.log2(t)));return{width:Math.max(1,Math.min(n,a.default.maxTextureSize)),height:Math.max(1,Math.min(r,a.default.maxTextureSize))}}}]),e}();t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),l=r(s),c=n(2),f=r(c),d=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$mount",value:function(){var e=this;this.texture=new f.default(this.companion.get("gl")),this.texture.magFilter=this.getAttribute("magFilter"),this.texture.minFilter=this.getAttribute("minFilter"),this.texture.wrapT=this.getAttribute("wrapT"),this.texture.wrapS=this.getAttribute("wrapS"),this.getAttributeRaw("magFilter").watch(function(t){return e.texture.magFilter=t}),this.getAttributeRaw("minFilter").watch(function(t){return e.texture.minFilter=t}),this.getAttributeRaw("wrapS").watch(function(t){return e.texture.wrapS=t}),this.getAttributeRaw("wrapT").watch(function(t){return e.texture.wrapT=t})}},{key:"$unmount",value:function(){this.texture.destroy(),this.texture=null}}]),t}(l.default);t.default=d,d.attributes={minFilter:{converter:"Enum",default:"LINEAR",table:{LINEAR:WebGLRenderingContext.LINEAR,NEAREST:WebGLRenderingContext.NEAREST,NEAREST_MIPMAP_NEAREST:WebGLRenderingContext.NEAREST_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:WebGLRenderingContext.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_NEAREST:WebGLRenderingContext.LINEAR_MIPMAP_NEAREST,LINEAR_MIPMAP_LINEAR:WebGLRenderingContext.LINEAR_MIPMAP_LINEAR}},magFilter:{converter:"Enum",default:"LINEAR",table:{LINEAR:WebGLRenderingContext.LINEAR,NEAREST:WebGLRenderingContext.NEAREST}},wrapS:{converter:"Enum",default:"REPEAT",table:{REPEAT:WebGLRenderingContext.REPEAT,MIRRORED_REPEAT:WebGLRenderingContext.MIRRORED_REPEAT,CLAMP_TO_EDGE:WebGLRenderingContext.CLAMP_TO_EDGE}},wrapT:{converter:"Enum",default:"REPEAT",table:{REPEAT:WebGLRenderingContext.REPEAT,MIRRORED_REPEAT:WebGLRenderingContext.MIRRORED_REPEAT,CLAMP_TO_EDGE:WebGLRenderingContext.CLAMP_TO_EDGE}}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},a=function(){function e(){r(this,e),this._resolved={},this._resolvers={},this._handlers={}}return o(e,[{key:"get",value:function(e){return void 0!==this._resolved[e]?Promise.resolve(this._resolved[e]):this._waitForResolved(e)}},{key:"getStatus",value:function(t){return void 0!==this._resolvers[t]?e.RESOLVING:void 0!==this._resolved[t]?e.RESOLVED:e.UNLOADED}},{key:"register",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this._isPromise(t)){n.next=19;break}if(n.prev=1,void 0===this._resolvers[e]){n.next=4;break}throw new Error("Dupelicated named resource '"+e+"' was registered.");case 4:return this._resolvers[e]=t,n.next=7,t;case 7:return r=n.sent,this._resolvers[e]=void 0,this._callHandlers(e,r),this._resolved[e]=r,n.abrupt("return",r);case 14:throw n.prev=14,n.t0=n.catch(1),new Error("Unexpected error has occured during resolution of named resource '"+e+"'\n"+n.t0);case 17:n.next=20;break;case 19:return n.abrupt("return",this.register(e,Promise.resolve(t)));case 20:case"end":return n.stop()}},n,this,[[1,14]])}))}},{key:"_waitForResolved",value:function(e){var t=this;return new Promise(function(n,r){void 0===t._handlers[e]&&(t._handlers[e]=[]),t._handlers[e].push(function(e){n(e)})})}},{key:"_callHandlers",value:function(e,t){void 0!==this._handlers[e]&&(this._handlers[e].forEach(function(e){return e(t)}),delete this._handlers[e])}},{key:"_isPromise",value:function(e){return"function"==typeof e.then}}]),e}();t.default=a,a.UNLOADED=0,a.RESOLVING=1,a.RESOLVED=2},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(35),l=r(s),c=n(0),f=r(c),d=n(34),h=r(d),p=n(16),_=r(p),v=function(){function e(){a(this,e),this.coroutines=[]}return u(e,[{key:"callCoroutine",value:function(e,t){var n=this,r=void 0;this.coroutines.forEach(function(n){if(n.next<=e){if(n.container.disposed)return r||(r=[]),void r.push(n);if(!n.container.isActive)return;var o=n.coroutine.next(t);o.done||o.value<0?(r||(r=[]),r.push(n)):n.next+o.value<e?n.next=e:n.next=n.next+o.value}}),r&&r.forEach(function(e){var t=n.coroutines.indexOf(e);n.coroutines.splice(t,1)})}},{key:"register",value:function(e,t,n){var r=t.call(e);this.coroutines.push({coroutine:r,next:0,container:e,tag:n})}},{key:"unregister",value:function(e,t){var n=this,r=[];t?this.coroutines.forEach(function(n){n.container===e&&n.tag===t&&r.push(n)}):this.coroutines.forEach(function(t){t.container===e&&r.push(t)}),r.forEach(function(e){var t=n.coroutines.indexOf(e);n.coroutines.splice(t)})}}]),e}(),y=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"__registerTimerCoroutine",value:function(e,t){var n=this.companion.get("timer-coroutine");n||(n=new v,this.loopManager.register(function(e){return n.callCoroutine(e.time,e)},100),this.companion.set(l.default.define(this.node.name.ns.qualifiedName).for("timer-coroutine"),n)),n.register(this,e,t)}},{key:"__registerFrameCoroutine",value:function(e,t){var n=this.companion.get("frame-coroutine");n||(n=new v,this.loopManager.register(function(e){return n.callCoroutine(e.frameCount,e)},100),this.companion.set(l.default.define(this.node.name.ns.qualifiedName).for("frame-coroutine"),n)),n.register(this,e,t)}},{key:"__invoke",value:function(e,t){var n=this;this.__registerTimerCoroutine(regeneratorRuntime.mark(function r(){var o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t;case 2:o=r.sent,e.call(n,o);case 4:case"end":return r.stop()}},r,this)}))}},{key:"__unregisterTimerCoroutine",value:function(e){var t=this.companion.get("timer-coroutine");t&&t.unregister(this,e)}},{key:"__unregisterFrameCoroutine",value:function(e){var t=this.companion.get("frame-coroutine");t&&t.unregister(this,e)}},{key:"__registerAssetLoading",value:function(e){return this.assetLoadingManager.loader.register(e,this)}},{key:"loopManager",get:function(){return this._loopManagerBackingStore||(this._loopManagerBackingStore=this.node.getComponentInAncestor(_.default)),this._loopManagerBackingStore}},{key:"assetLoadingManager",get:function(){return this._assetLoadingManagerBackingStore||(this._assetLoadingManagerBackingStore=this.node.getComponentInAncestor(h.default)),this._assetLoadingManagerBackingStore}}]),t}(f.default);t.default=y,y.attributes={}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),l=r(s),c=n(51),f=r(c),d=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._loopActions=[],e}return a(t,e),u(t,[{key:"$awake",value:function(){var e=this;this._registerNextLoop=window.requestAnimationFrame?function(){window.requestAnimationFrame(e._loop.bind(e))}:function(){window.setTimeout(e._loop.bind(e),1e3/60)}}},{key:"$mount",value:function(){var e=this;this.getAttributeRaw("loopEnabled").watch(function(t){t&&e._begin()}),this._timer=new f.default,this.getAttributeRaw("fpsRestriction").watch(function(t){e._timer.fpsRestriction=t},!0),this._timer.internalUpdate()}},{key:"register",value:function(e,t){this._loopActions.push({action:e,priorty:t}),this._loopActions.sort(function(e,t){return e.priorty-t.priorty})}},{key:"_begin",value:function(){this._registerNextLoop()}},{key:"_loop",value:function(){var e=this;this._timer.internalUpdate()&&(this.node.emit("loop",{timer:this._timer}),this._loopActions.forEach(function(t){return t.action(e._timer)})),this._registerNextLoop()}}]),t}(l.default);t.default=d,d.attributes={loopEnabled:{default:!1,converter:"Boolean"},fpsRestriction:{default:60,converter:"Number"}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS&&window.GrimoireJS.lib.math?window.GrimoireJS.lib.math.Matrix:void 0},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS&&window.GrimoireJS.lib.math?window.GrimoireJS.lib.math.Vector4:void 0},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),l=r(s),c=n(54),f=r(c),d=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.queueRegistory=new f.default,e}return a(t,e),u(t,[{key:"$mount",value:function(){var e=this;this.sceneDescription={},t._sceneDescriptionCreationHandlers.forEach(function(t){return t(e.sceneDescription,e)})}},{key:"updateScene",value:function(e){if(this._lastUpdateIndex!==e.frameCount){var t={sceneDescription:this.sceneDescription,timer:e};this.node.broadcastMessage("update",t),this._lastUpdateIndex=e.frameCount}}}],[{key:"onSceneDescriptionCreation",value:function(e){t._sceneDescriptionCreationHandlers.push(e)}}]),t}(l.default);t.default=d,d.attributes={},d._sceneDescriptionCreationHandlers=[]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),c=n(3),f=r(c),d=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.gl=e,n.extensions={},n._readyExtensions={},n._resolveRequested(),t._requestObserver.push(n._resolveExtensionSafely.bind(n)),n}return a(t,e),u(t,[{key:"_resolveRequested",value:function(){var e=this;t._requestedExtensions.forEach(function(t){e._resolveExtensionSafely(t.extensionName)})}},{key:"_resolveExtensionSafely",value:function(e){var n=t._requestedExtensions[t._requestIndexOf(e)];if(!this._resolveExtension(n.extensionName)&&n.isNecessary)throw new Error("A WebGL extension '"+n.extensionName+"' was requested. But that is not supported on this device.")}},{key:"_resolveExtension",value:function(e){if(this._readyExtensions[e])return!0;var n=void 0;return n=void 0===t._customExtensionResolvers[e]?this.extensions[e]=this.gl.getExtension(e):this.extensions[e]=t._customExtensionResolvers[e](this.gl),this._readyExtensions[e]=void 0!==this.extensions[e],n&&l.default.get(this.gl).macro.setValue(e.toUpperCase(),""),!!this._readyExtensions[e]}}],[{key:"get",value:function(e){return this.__get(e,t)}},{key:"supported",value:function(e){var n=t._getFirst();if(n)return void 0!==n.extensions[e]&&null!==n.extensions[e];throw new Error("There was no WebGLRenderingContext initialized yet")}},{key:"request",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t._requestIndexOf(e);r>-1&&n?t._requestedExtensions[r]={extensionName:e,isNecessary:n}:-1===r&&t._requestedExtensions.push({extensionName:e,isNecessary:n}),t._requestObserver.forEach(function(t){return t(e)})}},{key:"_getFirst",value:function(){return t.__getAll(t)[0]}},{key:"_requestIndexOf",value:function(e){for(var n=0;n<t._requestedExtensions.length;n++)if(t._requestedExtensions[n].extensionName===e)return n;return-1}}]),t}(f.default);t.default=d,d.registryName="GLExtensionRequestor",d._customExtensionResolvers={},d._requestObserver=[],d._requestedExtensions=[],d._customExtensionResolvers.WEBGL_color_buffer_float=function(e){var t=void 0;if(null===e.getExtension("WEBGL_color_buffer_float")){var n=e.createFramebuffer(),r=e.createTexture();e.bindFramebuffer(e.FRAMEBUFFER,n),e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.FLOAT,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0),t=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE,e.deleteTexture(r),e.deleteFramebuffer(n)}else t=!0;return t}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(3),s=function(e){return e&&e.__esModule?e:{default:e}}(u),l=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},c=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.gl=e,n}return i(t,e),a(t,[{key:"instanciate",value:function(e,n){return l(this,void 0,void 0,regeneratorRuntime.mark(function r(){var o,i,a,u,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(o=t.factoryDelegates[e]){r.next=3;break}throw new Error("Can not instanciate unknown geometry type "+e);case 3:return r.next=5,o(this.gl,n);case 5:if(i=r.sent,void 0===t.factoryExtentions[e]){r.next=17;break}a=t.factoryExtentions[e],u=0;case 9:if(!(u<a.length)){r.next=17;break}if(!(s=a[u](i,n))){r.next=14;break}return r.next=14,s;case 14:u++,r.next=9;break;case 17:return r.abrupt("return",i);case 18:case"end":return r.stop()}},r,this)}))}},{key:"instanciateAsDefault",value:function(e){var n=t.factoryArgumentDeclarations[e],r={};for(var o in n){var i=n[o];r[o]=i.default}return this.instanciate(e,r)}}],[{key:"get",value:function(e){return this.__get(e,t)}},{key:"addType",value:function(e,n,r){t.factoryDelegates[e]=r,t.factoryArgumentDeclarations[e]=n}},{key:"extend",value:function(e,n){void 0===t.factoryExtentions[e]&&(t.factoryExtentions[e]=[]),t.factoryExtentions[e].push(n)}}]),t}(s.default);t.default=c,c.registryName="GeometryFactory",c.factoryDelegates={},c.factoryArgumentDeclarations={},c.factoryExtentions={}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(5),l=r(s),c=n(88),f=r(c),d=n(40),h=r(d),p=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},_=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.materialArgs={},e.materialReady=!1,e.useMaterial=!1,e}return a(t,e),u(t,[{key:"getDrawPriorty",value:function(e,t){if(!this.materialReady&&!this.isActive)return Number.MAX_VALUE;var n=void 0;if(void 0===(n="Auto"===this._drawOrder?"Auto"===this.material.techniques[t].drawOrder?f.default[this._transparent?"UseAlpha":"NoAlpha"]:f.default[this.material.techniques[t].drawOrder]:f.default[this._drawOrder]))throw new Error('Specified drawing order "'+this.material.techniques[t].drawOrder+'" is not defined');return n.descending?(1-e/1e4)*n.priorty:e/1e4*n.priorty}},{key:"$mount",value:function(){this.getAttributeRaw("material").watch(this._onMaterialChanged.bind(this)),this.__registerAssetLoading(this._onMaterialChanged()),this.getAttributeRaw("drawOrder").boundTo("_drawOrder"),this.getAttributeRaw("transparent").boundTo("_transparent")}},{key:"_onMaterialChanged",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=this.getAttribute("material"))){e.next=4;break}return this.useMaterial=!1,e.abrupt("return");case 4:if(this.useMaterial=!0,this._registeredAttributes&&this.__removeExposedMaterialParameters(),this._materialComponent){e.next=11;break}return e.next=9,this._prepareInternalMaterial(t);case 9:e.next=13;break;case 11:return e.next=13,this._prepareExternalMaterial(t);case 13:case"end":return e.stop()}},e,this)}))}},{key:"_prepareExternalMaterial",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:n=t.sent,this.material=n,this.materialArgs=this._materialComponent.materialArgs,this.materialReady=!0;case 6:case"end":return t.stop()}},t,this)}))}},{key:"_prepareInternalMaterial",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e;case 4:n=t.sent,this.material=n,this.__exposeMaterialParameters(this.material),this._registeredAttributes=!0,this.materialReady=!0;case 9:case"end":return t.stop()}},t,this)}))}}],[{key:"rewriteDefaultMaterial",value:function(e){e!==t._defaultMaterial&&(t._defaultMaterial=e,l.default.componentDeclarations.get("MaterialContainer").attributes.material.default="new("+e+")")}},{key:"defaultMaterial",get:function(){return this._defaultMaterial}}]),t}(h.default);t.default=_,_.attributes={material:{converter:"Material",default:"new(unlit)",componentBoundTo:"_materialComponent"},drawOrder:{converter:"String",default:"Auto"},transparent:{converter:"Boolean",default:!0}},_._defaultMaterial="unlit"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),l=r(s),c=n(92),f=r(c),d=n(24),h=r(d),p=n(12),_=r(p),v=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._wasInside=!1,e}return a(t,e),u(t,[{key:"$awake",value:function(){var e=this;this.getAttributeRaw("camera").boundTo("camera"),this.getAttributeRaw("viewport").watch(function(t){e._viewportSizeGenerator=t,e.$resizeCanvas()}),this._viewportSizeGenerator=this.getAttribute("viewport");var t=this.getAttribute("regionName");t||(t="renderer-"+this.node.index),this.renderingTarget=new f.default(this.companion.get("gl")),this.renderingTarget.setViewport(this.viewport),h.default.get(this.companion.get("gl")).setRenderingTarget(t,this.renderingTarget),this._initializeMouseHandlers()}},{key:"$mount",value:function(){var e=this;this._gl=this.companion.get("gl"),this._canvas=this.companion.get("canvasElement"),this.getAttributeRaw("handleMouse").watch(function(t){t?e._enableMouseHandling():e._disableMouseHandling()},!0),0===this.node.children.length&&this.node.addChildByName("render-scene",{}),this.$resizeCanvas()}},{key:"$unmount",value:function(){this._disableMouseHandling()}},{key:"$treeInitialized",value:function(){this.$resizeCanvas()}},{key:"$resizeCanvas",value:function(){this._viewportCache=this._viewportSizeGenerator(this._canvas),this.renderingTarget.setViewport(this._viewportCache);var e=_.default.getPow2Size(this._viewportCache.Width,this._viewportCache.Height);this.node.broadcastMessage("resizeViewport",{width:this._viewportCache.Width,height:this._viewportCache.Height,pow2Width:e.width,pow2Height:e.height})}},{key:"$renderViewport",value:function(e){this.node.broadcastMessage("render",{camera:this.camera,viewport:this._viewportCache,timer:e.timer})}},{key:"_initializeMouseHandlers",value:function(){var e=this;this._mouseMoveHandler=function(t){e._isViewportInside(t)?(e._wasInside||e._sendMouseEvent("mouseenter",t),e._sendMouseEvent("mousemove",t),e._wasInside=!0):(e._wasInside&&e._sendMouseEvent("mouseleave",t),e._wasInside=!1)},this._mouseEnterHandler=function(t){e._isViewportInside(t)&&(e._sendMouseEvent("mouseenter",t),e._wasInside=!0)},this._mouseLeaveHandler=function(t){e._wasInside&&e._sendMouseEvent("mouseleave",t),e._wasInside=!1},this._mouseDownHandler=function(t){e._isViewportInside(t)&&(e._sendMouseEvent("mousedown",t),e._wasInside=!0)},this._mouseUpHandler=function(t){e._sendMouseEvent("mouseup",t)}}},{key:"_enableMouseHandling",value:function(){this._canvas.addEventListener("mousemove",this._mouseMoveHandler),this._canvas.addEventListener("mouseleave",this._mouseLeaveHandler),this._canvas.addEventListener("mouseenter",this._mouseEnterHandler),this._canvas.addEventListener("mousedown",this._mouseDownHandler),this._canvas.addEventListener("mouseup",this._mouseUpHandler)}},{key:"_disableMouseHandling",value:function(){this._canvas.removeEventListener("mousemove",this._mouseMoveHandler),this._canvas.removeEventListener("mouseleave",this._mouseLeaveHandler),this._canvas.removeEventListener("mouseenter",this._mouseEnterHandler),this._canvas.removeEventListener("mousedown",this._mouseDownHandler),this._canvas.removeEventListener("mouseup",this._mouseUpHandler)}},{key:"_sendMouseEvent",value:function(e,t){this.isActive&&(this.node.emit(e),this.node.broadcastMessage(e,this._toViewportMouseArgs(t)))}},{key:"_isViewportInside",value:function(e){var t=this._getRelativePosition(e),n=this._viewportCache.toLocalNormalized(t[0],t[1]);return n[0]>=0&&n[0]<=1&&n[1]>=0&&n[1]<=1}},{key:"_getRelativePosition",value:function(e){var t=this._canvas.getBoundingClientRect(),n=t.left+window.pageXOffset,r=t.top+window.pageYOffset;return[e.pageX-n,t.height-(e.pageY-r),t.width,t.height]}},{key:"_toViewportMouseArgs",value:function(e){var t=this._getRelativePosition(e),n=this._viewportCache.toLocal(t[0],t[1]),r=this._viewportCache.toLocalNormalized(t[0],t[1]);return Object.assign({},e,{viewportX:n[0],viewportY:n[1],viewportNormalizedX:r[0],viewportNormalizedY:r[1],canvasX:t[0],canvasY:t[1],canvasNormalizedX:t[0]/t[2],canvasNormalizedY:t[1]/t[3],inside:this._isViewportInside(e)})}},{key:"viewport",get:function(){return this._viewportCache?this._viewportCache:(this._viewportCache=this._viewportSizeGenerator(this.companion.get("gl").canvas),this._viewportCache)}}]),t}(l.default);t.default=v,v.attributes={regionName:{converter:"String",default:null},camera:{converter:"Component",default:"camera",target:"Camera"},viewport:{converter:"Viewport",default:"auto"},handleMouse:{converter:"Boolean",default:!0}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(3),l=r(s),c=n(41),f=r(c),d=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},h=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.gl=e,n._renderingTargets={},n._renderingTargetResolver={},n.setRenderingTarget("canvas",new f.default(e)),n}return a(t,e),u(t,[{key:"setRenderingTarget",value:function(e,t){if("default"===e)throw new Error("Rendering target can't be named as 'default'.");this._renderingTargets[e]=t,this._resolveRenderingTargets(e,t)}},{key:"getRenderingTarget",value:function(e){return d(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=this._renderingTargets[e])){t.next=5;break}return t.abrupt("return",n);case 5:return t.abrupt("return",this._waitForRenderingTarget(e));case 6:case"end":return t.stop()}},t,this)}))}},{key:"_waitForRenderingTarget",value:function(e){return d(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===this._renderingTargetResolver[e]&&(this._renderingTargetResolver[e]=[]),t.abrupt("return",new Promise(function(t,r){n._renderingTargetResolver[e].push(t)}));case 2:case"end":return t.stop()}},t,this)}))}},{key:"_resolveRenderingTargets",value:function(e,t){var n=this._renderingTargetResolver[e];n&&n.forEach(function(e){return e(t)})}},{key:"targetNames",get:function(){return Object.keys(this._renderingTargets)}}],[{key:"get",value:function(e){return this.__get(e,t)}}]),t}(l.default);t.default=h,h.registryName="RenderingTargetRegistry"},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},s=n(4),l=function(e){return e&&e.__esModule?e:{default:e}}(s),c=function(e){function t(e){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,e.createRenderbuffer()))}return i(t,e),a(t,[{key:"update",value:function(e,t,n){this.gl.bindRenderbuffer(WebGLRenderingContext.RENDERBUFFER,this.resourceReference),this.gl.renderbufferStorage(WebGLRenderingContext.RENDERBUFFER,e,t,n),this.valid=!0}},{key:"bind",value:function(){this.gl.bindRenderbuffer(WebGLRenderingContext.RENDERBUFFER,this.resourceReference)}},{key:"destroy",value:function(){this.gl.deleteRenderbuffer(this.resourceReference),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(l.default);t.default=c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(3),s=function(e){return e&&e.__esModule?e:{default:e}}(u),l=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.gl=e,n.backbuffers={},n.depthBuffers={},n}return i(t,e),a(t,[{key:"setBackbuffer",value:function(e,t){this.backbuffers[e]=t}},{key:"getBackbuffer",value:function(e){return this.backbuffers[e]}},{key:"setDepthBuffer",value:function(e,t){this.depthBuffers[e]=t}},{key:"getDepthBuffer",value:function(e){return this.depthBuffers[e]}}],[{key:"get",value:function(e){return this.__get(e,t)}}]),t}(s.default);t.default=l,l.registryName="RenderingBufferResourceRegistry"},function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(15),l=r(s),c=n(44),f=r(c),d=n(28),h=r(d),p=n(45),_=r(p),v=function(t){function n(){return o(this,n),i(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return a(n,t),u(n,[{key:"resize",value:function(e,t){}},{key:"$awake",value:function(){var t=this;if(!this.node.getComponent(h.default)){var r=this.getAttribute("resizerType"),o=n.resizers[r];if(!o)throw new Error("Specified resizer '"+r+"' is not yet registered to resizable resource updator");e(function(){t.node.addComponent(o)})}}}]),n}(l.default);t.default=v,v.resizers={ViewportSize:_.default,Constant:f.default},v.attributes={resizerType:{converter:"String",default:"Constant"}}}).call(t,n(95).setImmediate)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),l=r(s),c=n(12),f=r(c),d=n(27),h=r(d),p=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._lastWidth=0,e._lastHeight=0,e}return a(t,e),u(t,[{key:"__resizeResources",value:function(e,t){if(this.getAttribute("keepPow2Size")){var n=f.default.getPow2Size(e,t);e=n.width,t=n.height}e===this._lastWidth&&t===this._lastHeight||(this.node.getComponents(h.default).forEach(function(n){return n.resize(e,t)}),this._lastWidth=e,this._lastHeight=t)}}]),t}(l.default);t.default=p,p.attributes={keepPow2Size:{converter:"Boolean",default:!0}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},s=n(98),l=function(e){return e&&e.__esModule?e:{default:e}}(s),c=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"$awake",value:function(){var e=this;this.getAttributeRaw("clearColor").boundTo("clearColor"),this.getAttributeRaw("clearColorEnabled").boundTo("clearColorEnabled"),this.getAttributeRaw("clearDepthEnabled").boundTo("clearDepthEnabled"),this.getAttributeRaw("clearDepth").boundTo("clearDepth"),this.getAttributeRaw("out").watch(function(t){e._out=t,t.then(function(t){return e.out=t})},!0)}},{key:"__beforeRender",value:function(){if(!u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"__beforeRender",this).call(this))return!1;if(!this.out)return!1;var e=0;return this.clearColorEnabled&&(e|=WebGLRenderingContext.COLOR_BUFFER_BIT),this.clearDepthEnabled&&(e|=WebGLRenderingContext.DEPTH_BUFFER_BIT),this.out.beforeDraw(e,this.clearColor.rawElements,this.clearDepth),!0}}]),t}(l.default);t.default=c,c.attributes={out:{converter:"RenderingTarget",default:"default"},clearColor:{default:"#0000",converter:"Color4"},clearColorEnabled:{default:!0,converter:"Boolean"},clearDepthEnabled:{default:!0,converter:"Boolean"},clearDepth:{default:1,converter:"Number"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(27),c=r(l),f=n(13),d=r(f),h=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"$awake",this).call(this),this.textureComponent=this.node.getComponent(d.default)}},{key:"__texture",get:function(){return this.textureComponent.texture}}]),t}(c.default);t.default=h,h.attributes={flipY:{converter:"Boolean",default:!0},premultipliedAlpha:{converter:"Boolean",default:!1}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},a=function(){function e(t){r(this,e),this.toAbsolute=t,this.cache={},this.resolvers={}}return o(e,[{key:"resolve",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=this.toAbsolute(e),!this._cached(r)){n.next=5;break}return n.abrupt("return",this.cache[r]);case 5:if(!this._resolving(r)){n.next=11;break}return n.next=8,this.resolvers[r];case 8:return n.abrupt("return",n.sent);case 11:return this.resolvers[r]=t(r),n.next=14,this.resolvers[r];case 14:return o=n.sent,this._resolved(r,o),n.abrupt("return",o);case 17:case"end":return n.stop()}},n,this)}))}},{key:"_cached",value:function(e){return void 0!==this.cache[e]}},{key:"_resolving",value:function(e){return void 0!==this.resolvers[e]}},{key:"_resolved",value:function(e,t){delete this.resolvers[e],this.cache[e]=t}}]),e}();t.default=a},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(31),s=function(e){return e&&e.__esModule?e:{default:e}}(u),l=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,t._toAbsolute))}return i(t,e),a(t,null,[{key:"isDataURL",value:function(e){return!!e.match(/^\s*data\:.*;base64/)}},{key:"_toAbsolute",value:function(e){if(e.match(/^blob\:/m)||t.isDataURL(e))return e;var n=document.createElement("a");return n.href=e,n.protocol+"//"+n.host+n.pathname+n.search+n.hash}}]),t}(s.default);t.default=l},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ImageResolver=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},s=n(32),l=function(e){return e&&e.__esModule?e:{default:e}}(s),c=t.ImageResolver=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"resolve",value:function(e){var n=this;return u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resolve",this).call(this,e,function(t){return new Promise(function(r,o){var i=new Image;i.crossOrigin=n._getCORSConfig(t),i.onload=function(){r(i)},i.onerror=function(n){o('Error has been occured during loading "'+t+"("+e+')"\n'+n)},i.src=t})})}},{key:"_getCORSConfig",value:function(e){for(var n=null,r=0;r<t.corsResolvers.length&&null===(n=t.corsResolvers[r](e));r++);return null===n&&(n=t.defaultCORSConfig),n}}]),t}(l.default);c.defaultCORSConfig="anonymous",c.corsResolvers=[],t.default=new c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),l=r(s),c=n(117),f=r(c),d=n(48),h=r(d),p=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},_=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.loader=new h.default,e}return a(t,e),u(t,[{key:"$treeInitialized",value:function(){this.getAttribute("autoStart")&&this._autoStart(),this._documentResolver()}},{key:"$awake",value:function(){var e=this;this.companion.set(this.name.ns.for("loader"),this.loader),this.loader.register(new Promise(function(t){e._documentResolver=t}),this);var t=this.companion.get("canvasContainer");if(this.getAttribute("enableLoader")){var n=document.createElement("div");n.innerHTML=f.default,n.style.width=n.style.height="100%",t.appendChild(n),this._loaderElement=n}}},{key:"_autoStart",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loader.promise;case 2:this._loaderElement&&this._loaderElement.remove(),this.node.emit("asset-load-completed"),this.tree("goml").setAttribute("loopEnabled",!0),t=this.companion.get("canvasElement"),t.classList.add("gr-resource-loaded-canvas");case 7:case"end":return e.stop()}},e,this)}))}}]),t}(l.default);t.default=_,_.attributes={loadingProgress:{default:0,converter:"Number"},autoStart:{default:!0,converter:"Boolean"},enableLoader:{default:!0,converter:"Boolean"}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Base.Namespace},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS&&window.GrimoireJS.lib.math?window.GrimoireJS.lib.math.GLM:void 0},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(67),a=function(e){return e&&e.__esModule?e:{default:e}}(i),u=function(){function e(t,n){r(this,e),this.gl=t,this.techniqueRecipes=n,this.techniques={};for(var o in n)this.techniques[o]=new a.default(this,n[o])}return o(e,[{key:"draw",value:function(e){var t=this.techniques[e.technique];t&&t.draw(e)}},{key:"clone",value:function(){var t=new e(this.gl,this.techniqueRecipes);for(var n in this.techniques){var r=this.techniques[n],o=t.techniques[n];for(var i in r.passes){var a=r.passes[i],u=o.passes[i];for(var s in a.arguments)u[s]=a[s]}}return t}}]),e}();t.default=u},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){r(this,e)}return o(e,null,[{key:"typeToTypedArrayConstructor",value:function(e){switch(e){case WebGLRenderingContext.UNSIGNED_BYTE:return Uint8Array;case WebGLRenderingContext.UNSIGNED_SHORT:return Uint16Array;case WebGLRenderingContext.UNSIGNED_INT:return Uint32Array;case WebGLRenderingContext.BYTE:return Int8Array;case WebGLRenderingContext.SHORT:return Int16Array;case WebGLRenderingContext.INT:return Int32Array;case WebGLRenderingContext.FLOAT:return Float32Array;default:throw new Error("Element type "+e+" is not valid for buffer elements")}}},{key:"arrayBufferToElementType",value:function(e){if(e instanceof Uint8Array)return WebGLRenderingContext.UNSIGNED_BYTE;if(e instanceof Uint16Array)return WebGLRenderingContext.UNSIGNED_SHORT;if(e instanceof Uint32Array)return WebGLRenderingContext.UNSIGNED_INT;if(e instanceof Int8Array)return WebGLRenderingContext.BYTE;if(e instanceof Int16Array)return WebGLRenderingContext.SHORT;if(e instanceof Int32Array)return WebGLRenderingContext.INT;if(e instanceof Float32Array)return WebGLRenderingContext.FLOAT;throw new Error("Unknown buffer element type")}},{key:"formatToElementCount",value:function(e){switch(e){case WebGLRenderingContext.RGBA:return 4;case WebGLRenderingContext.RGB:return 3;default:throw new Error("Unknown buffer format")}}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),c=n(40),f=r(c),d=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},h=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.materialArgs={},e}return a(t,e),u(t,[{key:"$mount",value:function(){var e=this.getAttribute("type");if(!e||"string"!=typeof e)throw new Error("Material type name must be sppecified and string");var t=l.default.get(this.companion.get("gl"));this.materialPromise=t.instanciate(e),this._registerAttributes()}},{key:"_registerAttributes",value:function(){return d(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.materialPromise;case 2:this.material=e.sent,this.__exposeMaterialParameters(this.material),this.ready=!0;case 5:case"end":return e.stop()}},e,this)}))}}]),t}(f.default);t.default=h,h.attributes={type:{converter:"String",default:null}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(35),l=r(s),c=n(15),f=r(c),d=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._lastParameters={},e}return a(t,e),u(t,[{key:"__exposeMaterialParameters",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r={};for(var o in e.techniques){var i=e.techniques[o];for(var a in i.passes)!function(e){var a=i.passes[e],u=l.default.define(o+".pass"+e);for(var s in a.argumentDeclarations)!function(e){var o=u.for(e).fqn;r[o]=a.argumentDeclarations[e],t.__addAttribute(o,a.argumentDeclarations[e]);try{void 0!==a.arguments[e]?t.setAttribute(o,a.arguments[e]):n&&void 0!==t._lastParameters[o]&&t._lastParameters[o].converter===a.argumentDeclarations[e].converter&&t.setAttribute(o,t._lastParameters[o].__lastValue),t.getAttributeRaw(o).watch(function(t,n){a.setArgument(e,t,n)},!0)}catch(e){throw new Error("Parsing variable failed")}}(s)}(a)}this._lastParameters=r}},{key:"__removeExposedMaterialParameters",value:function(){for(var e in this._lastParameters)this._lastParameters[e].__lastValue=this.getAttribute(e),this.__removeAttributes(e)}}]),t}(f.default);t.default=d},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(6),a=function(e){return e&&e.__esModule?e:{default:e}}(i),u=function(){function e(t){r(this,e),this.gl=t}return o(e,[{key:"beforeDraw",value:function(e,t,n){if(this.gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),e){this.__configureClearScissor();var r=0;0!=(e&WebGLRenderingContext.COLOR_BUFFER_BIT)&&t&&(this.gl.clearColor.apply(this.gl,t),r|=WebGLRenderingContext.COLOR_BUFFER_BIT),0!=(e&WebGLRenderingContext.DEPTH_BUFFER_BIT)&&null!==n&&(this.gl.clearDepth(n),r|=WebGLRenderingContext.DEPTH_BUFFER_BIT),0!==r&&this.gl.clear(r)}this.getViewport().configure(this.gl)}},{key:"getBufferWidth",value:function(){return this.gl.canvas.width}},{key:"getBufferHeight",value:function(){return this.gl.canvas.height}},{key:"getViewport",value:function(){return new a.default(0,0,this.getBufferWidth(),this.getBufferHeight())}},{key:"__configureClearScissor",value:function(){this.gl.disable(WebGLRenderingContext.SCISSOR_TEST)}}]),e}();t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(4),c=r(l),f=n(25),d=r(f),h=n(2),p=r(h),_=function(e){function t(e){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,e.createFramebuffer()))}return a(t,e),u(t,[{key:"update",value:function(e,t,n){if(this.gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,this.resourceReference),e instanceof p.default){if(void 0===n&&(n=0),void 0===t&&(t=0),this.gl.framebufferTexture2D(WebGLRenderingContext.FRAMEBUFFER,WebGLRenderingContext.COLOR_ATTACHMENT0+n,WebGLRenderingContext.TEXTURE_2D,e.resourceReference,t),this.gl.checkFramebufferStatus(WebGLRenderingContext.FRAMEBUFFER)!==WebGLRenderingContext.FRAMEBUFFER_COMPLETE)throw new Error("INCOMPLETE framebuffer")}else if(e instanceof d.default){var r=void 0===t?WebGLRenderingContext.DEPTH_ATTACHMENT:t;this.gl.framebufferRenderbuffer(WebGLRenderingContext.FRAMEBUFFER,r,WebGLRenderingContext.RENDERBUFFER,e.resourceReference)}this.gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null)}},{key:"bind",value:function(){this.gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,this.resourceReference)}},{key:"destroy",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.gl.deleteFramebuffer(this.resourceReference)}}]),t}(c.default);t.default=_},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(25),c=r(l),f=n(26),d=r(f),h=n(27),p=r(h),_=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"$awake",this).call(this),this.buffer=new c.default(this.companion.get("gl")),this.buffer.update(WebGLRenderingContext.DEPTH_COMPONENT16,1,1);var e=this.getAttribute("name");e&&d.default.get(this.companion.get("gl")).setDepthBuffer(e,this.buffer)}},{key:"$unmount",value:function(){this.buffer.destroy(),this.buffer=null}},{key:"resize",value:function(e,t){this.buffer.update(WebGLRenderingContext.DEPTH_COMPONENT16,e,t)}}]),t}(p.default);t.default=_,_.attributes={name:{converter:"String",default:null}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(28),s=function(e){return e&&e.__esModule?e:{default:e}}(u),l=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"$mount",value:function(){var e=this;this.getAttributeRaw("resolution").watch(function(t){var n=t;e.__resizeResources(n.X,n.Y)},!0)}}]),t}(s.default);t.default=l,l.attributes={resolution:{converter:"Vector2",default:"512,512"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(23),l=r(s),c=n(28),f=r(c),d=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$mount",value:function(){var e=this.node.getComponentInAncestor(l.default);if(!e)throw new Error("Resizable resource with ViewportSizeResourceResizer must be child of RendererComponent");this.__resizeResources(e.viewport.Width,e.viewport.Height)}},{key:"$resizeViewport",value:function(e){var t=this.getAttribute("resolutionScale");this.__resizeResources(e.width*t.X,e.height*t.Y)}}]),t}(f.default);t.default=d,d.attributes={resolutionScale:{converter:"Vector2",default:"1"},keepPow2Size:{converter:"Boolean",default:!0}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(18),a=function(e){return e&&e.__esModule?e:{default:e}}(i),u=function(){function e(){r(this,e)}return o(e,null,[{key:"fromIndex",value:function(e){return new a.default((511&e)/255,((130816&e)>>8)/255,((33488896&e)>>16)/255,((-16777216&e)>>24)/255)}},{key:"fromColor",value:function(e){return e[0]+(e[1]<<8)+(e[2]<<16)+(e[3]<<24)}}]),e}();t.default=u},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},s=n(29),l=function(e){return e&&e.__esModule?e:{default:e}}(s),c=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"$awake",value:function(){var e=this;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"$awake",this).call(this),this.metadata.type="scene",this.getAttributeRaw("layer").boundTo("layer"),this.getAttributeRaw("camera").boundTo("_camera"),this.getAttributeRaw("technique").boundTo("technique"),this.getAttributeRaw("camera").watch(function(t){e.metadata.camera=t?t.node.id:null},!0),this.getAttributeRaw("technique").watch(function(t){e.metadata.technique=t},!0),this.getAttributeRaw("layer").watch(function(t){e.metadata.layer=t},!0)}},{key:"$mount",value:function(){this._gl=this.companion.get("gl")}},{key:"$render",value:function(e){var t=this.camera?this.camera:e.camera;t&&this.__beforeRender()&&(t.updateContainedScene(e.timer),t.renderScene({renderer:this,camera:t,layer:this.layer,viewport:this.out.getViewport(),timer:e.timer,technique:this.technique,sceneDescription:{},rendererDescription:this.rendererDescription}))}}]),t}(l.default);t.default=c,c.attributes={layer:{converter:"String",default:"default"},camera:{default:null,converter:"Component",target:"Camera"},technique:{default:"default",converter:"String"}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(116),s=function(e){return e&&e.__esModule?e:{default:e}}(u),l=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},c=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.registerCount=0,e.loadCount=0,e.completeCount=0,e.errorCount=0,e.promise=new Promise(function(t){e._resolve=t}),e}return i(t,e),a(t,[{key:"register",value:function(e,t){return l(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.registerCount++,r=null,n.prev=2,n.next=5,e;case 5:r=n.sent,this.loadCount++,n.next=13;break;case 9:n.prev=9,n.t0=n.catch(2),console.error("Failed to resolve asset loading promise.\n\nLoading fired by: "+t.name.fqn+"\nAttached node:"+t.node.name.fqn+"\n"+n.t0),this.errorCount++;case 13:return this.completeCount++,this._checkLoadCompleted(),n.abrupt("return",r);case 16:case"end":return n.stop()}},n,this,[[2,9]])}))}},{key:"_checkLoadCompleted",value:function(){this.emit("progress",this),this.registerCount===this.completeCount&&this._resolve()}}]),t}(s.default);t.default=c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TextFileResolver=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},s=n(32),l=function(e){return e&&e.__esModule?e:{default:e}}(s),c=t.TextFileResolver=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"resolve",value:function(e){var n=this;return u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resolve",this).call(this,e,function(e){return t.isDataURL(e)?Promise.resolve(n._dataUriToText(e)):new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e),r.onload=function(e){t(r.responseText)},r.onerror=function(e){n(e)},r.send()})})}},{key:"_dataUriToText",value:function(e){var t=e.split(",");return atob(t[1])}}]),t}(l.default);t.default=new c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=t.VideoResolver=function(){function e(){r(this,e)}return o(e,[{key:"resolve",value:function(e){var t=this;return new Promise(function(n,r){var o=document.createElement("video");o.crossOrigin=t._getCORSConfig(e),o.preload="auto",o.addEventListener("canplay",function(){n(o)}),o.addEventListener("canplaythrough",function(){n(o)}),o.onerror=function(t){r('Error has been occured during loading "'+e+'"\n'+t)},o.src=e,o.load(),o.readyState>3&&n(o)})}},{key:"_getCORSConfig",value:function(t){for(var n=null,r=0;r<e.corsResolvers.length&&null===(n=e.corsResolvers[r](t));r++);return null===n&&(n=e.defaultCORSConfig),n}}]),e}();i.defaultCORSConfig="anonymous",i.corsResolvers=[],t.default=new i},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){r(this,e),this.timeScale=1,this.fpsRestriction=60,this._accumlatedSkipFrame=0,this._frameCount=0}return o(e,[{key:"internalUpdate",value:function(){this._frameCount++;var e=Date.now();return!!this._shouldUpdate(e)&&(this._updateTimer(e),!0)}},{key:"_shouldUpdate",value:function(e){if(void 0===this._time)return this._unrestrictedLastRealTime=e,!0;var t=e-this._unrestrictedLastRealTime,n=1e3/this.fpsRestriction;return this._unrestrictedLastRealTime=e,Math.abs(n-2*t-this._accumlatedSkipFrame)<Math.abs(n-t-this._accumlatedSkipFrame)?(this._accumlatedSkipFrame+=t,!1):(this._accumlatedSkipFrame=0,!0)}},{key:"_updateTimer",value:function(e){void 0===this._lastRealTime?(this._time=0,this._deltaTime=0):(this._deltaTime=e-this._lastRealTime,this._time+=this.timeScale*this._deltaTime),this._lastRealTime=e,void 0===this._lastFPS?0!==this.deltaTime&&(this._lastFPS=1e3/this.deltaTime):this._lastFPS=(this._lastFPS+1e3/this.deltaTime)/2}},{key:"deltaTime",get:function(){return this._deltaTime}},{key:"time",get:function(){return this._time}},{key:"timeInSecound",get:function(){return this._time/1e3}},{key:"frameCount",get:function(){return this._frameCount}},{key:"FPS",get:function(){return this._lastFPS?this._lastFPS.toFixed(2):Number.NaN}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(36),l=r(s),c=n(17),f=r(c),d=n(7),h=r(d),p=n(18),_=r(p),v=n(0),y=r(v),b=n(53),m=r(b),g=n(19),w=r(g),E=n(8),R=r(E),O=l.default.vec3,T=l.default.vec4,C=l.default.mat4,x=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.__viewMatrix=new f.default,e.__projectionMatrix=new f.default,e.__invProjectionMatrix=new f.default,e.__projectionViewMatrix=new f.default,e._renderQueue=new m.default,e._eyeCache=h.default.Zero,e._lookAtCache=h.default.Zero,e._upCache=h.default.Zero,e._orthographic=!1,e}return a(t,e),u(t,[{key:"$awake",value:function(){var e=this;this.getAttributeRaw("far").watch(function(t){e.Far=t},!0),this.getAttributeRaw("near").watch(function(t){e.Near=t},!0),this.getAttributeRaw("fovy").watch(function(t){e.Fovy=t},!0),this.getAttributeRaw("aspect").watch(function(t){e.Aspect=t},!0),this.getAttributeRaw("orthoSize").watch(function(t){e.OrthoSize=t},!0),this.getAttributeRaw("orthogonal").watch(function(t){e.OrthographicMode=t},!0),this.getAttributeRaw("autoAspect").boundTo("_autoAspect")}},{key:"$mount",value:function(){this.transform=this.node.getComponent(R.default),this.containedScene=t._findContainedScene(this.node),this.containedScene.queueRegistory.registerQueue(this._renderQueue),this.node.on("transformUpdated",this.updateTransform.bind(this)),this.updateTransform()}},{key:"$unmount",value:function(){this.containedScene.queueRegistory.unregisterQueue(this._renderQueue),this.containedScene=null}},{key:"getViewportRelativePosition",value:function(e){var t=void 0;return t=e instanceof R.default?e.globalPosition:e,f.default.transformPoint(this.ProjectionViewMatrix,t)}},{key:"updateContainedScene",value:function(e){this.containedScene&&this.containedScene.updateScene(e)}},{key:"renderScene",value:function(e){this.containedScene&&(this._justifyAspect(e),e.sceneDescription=this.containedScene.sceneDescription,this._renderQueue.renderAll(e))}},{key:"updateTransform",value:function(){var e=this.transform;O.transformMat4(this._eyeCache.rawElements,h.default.Zero.rawElements,e.globalTransform.rawElements),T.transformMat4(this._lookAtCache.rawElements,t._frontOrigin.rawElements,e.globalTransform.rawElements),O.add(this._lookAtCache.rawElements,this._lookAtCache.rawElements,this._eyeCache.rawElements),T.transformMat4(this._upCache.rawElements,t._upOrigin.rawElements,e.globalTransform.rawElements),C.lookAt(this.__viewMatrix.rawElements,this._eyeCache.rawElements,this._lookAtCache.rawElements,this._upCache.rawElements),C.mul(this.__projectionViewMatrix.rawElements,this.__projectionMatrix.rawElements,this.__viewMatrix.rawElements)}},{key:"_justifyAspect",value:function(e){if(this._autoAspect){var t=e.viewport.Width/e.viewport.Height;this._aspectCache!==t&&(this.setAttribute("aspect",t),this._aspectCache=t)}}},{key:"_recalculateProjection",value:function(){this._orthographic?C.ortho(this.__projectionMatrix.rawElements,-this._orthoSize*this._aspect,this._orthoSize*this._aspect,-this._orthoSize,this._orthoSize,this._near,this._far):C.perspective(this.__projectionMatrix.rawElements,this._fovy,this._aspect,this._near,this._far),C.mul(this.__projectionViewMatrix.rawElements,this.__projectionMatrix.rawElements,this.__viewMatrix.rawElements),C.invert(this.__invProjectionMatrix.rawElements,this.__projectionMatrix.rawElements)}},{key:"ViewMatrix",get:function(){return this.__viewMatrix}},{key:"ProjectionMatrix",get:function(){return this.__projectionMatrix}},{key:"InvProjectionMatrix",get:function(){return this.__invProjectionMatrix}},{key:"ProjectionViewMatrix",get:function(){return this.__projectionViewMatrix}},{key:"Far",get:function(){return this._far},set:function(e){this._far=e,this._recalculateProjection()}},{key:"Near",get:function(){return this._near},set:function(e){this._near=e,this._recalculateProjection()}},{key:"Aspect",get:function(){return this._aspect},set:function(e){this._aspect=e,this._recalculateProjection()}},{key:"Fovy",get:function(){return this._fovy},set:function(e){this._fovy=e,this._recalculateProjection()}},{key:"OrthoSize",get:function(){return this._orthoSize},set:function(e){this._orthoSize=e}},{key:"OrthographicMode",set:function(e){this._orthographic=e,this._recalculateProjection()},get:function(){return this._orthographic}},{key:"AutoAspect",set:function(e){this._autoAspect!==e&&(this._autoAspect=e,this._recalculateProjection())},get:function(){return this._autoAspect}}],[{key:"_findContainedScene",value:function(e){if(e.parent){var n=e.parent.getComponent(w.default);return n||t._findContainedScene(e.parent)}return null}}]),t}(y.default);t.default=x,x.attributes={fovy:{default:"45d",converter:"Angle2D"},near:{default:.01,converter:"Number"},far:{default:100,converter:"Number"},aspect:{default:1.6,converter:"Number"},autoAspect:{default:!0,converter:"Boolean"},orthoSize:{default:100,converter:"Number"},orthogonal:{default:!1,converter:"Boolean"}},x._frontOrigin=new _.default(0,0,-1,0),x._upOrigin=new _.default(0,1,0,0)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){r(this,e),this._sortedRenderablesByTechniques={},this._rendeables=[]}return o(e,[{key:"add",value:function(e){this._rendeables.push(e);for(var t in this._sortedRenderablesByTechniques)this._sortedRenderablesByTechniques[t].rendarables.push({renderable:e,priortyCache:0})}},{key:"remove",value:function(e){this._removeFromRenderables(e,this._rendeables);for(var t in this._sortedRenderablesByTechniques)this._removeFromRenderables(e,this._sortedRenderablesByTechniques[t].rendarables)}},{key:"renderAll",value:function(e){var t=e.sortingTechnique||e.technique;this._ensureCacheForTechnique(t),this._sortForTechnique(e,t),this._sortedRenderablesByTechniques[t].rendarables.forEach(function(t){t.renderable.render(e)})}},{key:"_sortForTechnique",value:function(e,t){var n=this._sortedRenderablesByTechniques[t];if(n.lastFrame!==e.timer.frameCount){for(var r=0;r<n.rendarables.length;r++)n.rendarables[r].priortyCache=n.rendarables[r].renderable.getRenderingPriorty(e.camera,t);n.rendarables.sort(function(e,t){return e.priortyCache-t.priortyCache}),n.lastFrame=e.timer.frameCount}}},{key:"_ensureCacheForTechnique",value:function(e){this._sortedRenderablesByTechniques[e]||(this._sortedRenderablesByTechniques[e]={lastFrame:-1,rendarables:this._rendeables.map(function(e){return{renderable:e,priortyCache:-1}})})}},{key:"_removeFromRenderables",value:function(e,t){for(var n=0;n<t.length;n++){var r=t[n];if((r.index||r.renderable.index)===e.index)break}t.length!==n&&t.splice(n,1)}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){r(this,e),this._queues=[],this._renderables=[]}return o(e,[{key:"registerQueue",value:function(e){this._queues.push(e),this._renderables.forEach(function(t){return e.add(t)})}},{key:"unregisterQueue",value:function(e){var t=this._queues.indexOf(e);t>-1&&this._queues.splice(t,1)}},{key:"addRenderable",value:function(e){this._renderables.push(e),this._queues.forEach(function(t){return t.add(e)}),e.setRenderableIndex(this._renderables.length)}},{key:"removeRenderable",value:function(e){var t=this._renderables.indexOf(e);-1!==t&&(this._renderables.splice(t,1),this._renderables.forEach(function(e,t){e.setRenderableIndex(t+1)}),this._queues.forEach(function(t){return t.remove(e)}))}},{key:"getByIndex",value:function(e){return this._renderables[e]}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(35),c=r(l),f=n(118),d=r(f),h=n(0),p=r(h),_=n(20),v=r(_),y=n(2),b=r(y),m=c.default.define("grimoirejs-fundamental");!function(e){e[e.Aspect=0]="Aspect",e[e.Fit=1]="Fit",e[e.Manual=2]="Manual"}(u||(u={}));var g=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"$awake",value:function(){var e=this;if(this._scriptTag=this.companion.get("scriptElement"),!this._isContainedInBody(this._scriptTag))throw new Error("goml script should have body as ancesotor to instanciate canvas element in the location");this._generateCanvas(this._scriptTag),this.getAttributeRaw("width").watch(function(){e._resize()}),this.getAttributeRaw("height").watch(function(){e._resize()}),this.getAttributeRaw("antialias").watch(function(){console.warn("Changing antialias attribute is not supported. This is only works when the canvas element created.")}),this.getAttributeRaw("preserveDrawingBuffer").watch(function(){console.warn("Changing preserveDrawingBuffer attribute is not supported. This is only works when the canvas element created.")})}},{key:"notifySizeChanged",value:function(){this._onWindowResize()}},{key:"_generateCanvas",value:function(e){var t=this;this._autoFixForBody(e),this.canvas=document.createElement("canvas"),window.addEventListener("resize",function(){return t._onWindowResize()}),this._configureCanvas(this.canvas,e);var n=this._getContext(this.canvas);return this.companion.set(m.for("gl"),n),this.companion.set(m.for("canvasElement"),this.canvas),this.companion.set(m.for("GLExtRequestor"),new v.default(n)),b.default.generateDefaultTexture(n),this.canvas}},{key:"_resize",value:function(e){var t=this.getAttribute("width"),n=this.getAttribute("height");if(this._widthMode=this._asResizeMode(t),this._heightMode=this._asResizeMode(n),this._widthMode===this._heightMode&&this._widthMode===u.Aspect)throw new Error("Width and height could not have aspect mode in same time!");this._widthMode===u.Aspect&&(this._ratio=t.aspect),this._heightMode===u.Aspect&&(this._ratio=n.aspect),this._widthMode===u.Manual&&this._applyManualWidth(t.size,e),this._heightMode===u.Manual&&this._applyManualHeight(n.size,e),this._onWindowResize(e)}},{key:"_onWindowResize",value:function(e){var t=this._getParentSize();this._widthMode===u.Fit&&this._applyManualWidth(t[0],e),this._heightMode===u.Fit&&(0===t[1]&&d.default.debug&&console.warn("Canvas height parameter specified as fit and height of parent element is 0.\n This is possibly the reason you haven't set css to html or body element."),this._applyManualHeight(t[1],e))}},{key:"_applyManualWidth",value:function(e,t){e!==this.canvas.width&&(this.canvas.width=e,this._canvasContainer.style.width=e+"px",t||this.node.broadcastMessage(1,"resizeCanvas"),this._heightMode===u.Aspect&&this._applyManualHeight(e/this._ratio,t))}},{key:"_applyManualHeight",value:function(e,t){e!==this.canvas.height&&(this.canvas.height=e,this._canvasContainer.style.height=e+"px",t||this.node.broadcastMessage(1,"resizeCanvas"),this._widthMode===u.Aspect&&this._applyManualWidth(e*this._ratio,t))}},{key:"_getParentSize",value:function(){var e=this._canvasContainer.parentElement,t=getComputedStyle(e),n=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),r=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),o=parseFloat(t.borderLeftWidth)+parseFloat(t.borderRightWidth),i=parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth);return[e.offsetWidth-n-o,e.offsetHeight-r-i]}},{key:"_asResizeMode",value:function(e){return"fit"===e.mode?u.Fit:"aspect"===e.mode?u.Aspect:u.Manual}},{key:"_configureCanvas",value:function(e,t){e.style.position="absolute",e.style.top="0px",e.style.left="0px",this._canvasContainer=document.createElement("div"),this._canvasContainer.style.position="relative",this._canvasContainer.style.overflow="hidden",this._canvasContainer.appendChild(e),this.getAttribute("containerId")&&(this._canvasContainer.id=this.getAttribute("containerId")),this.getAttribute("containerClass")&&(this._canvasContainer.className=this.getAttribute("containerClass")),this.companion.set(m.for("canvasContainer"),this._canvasContainer),t.parentElement.insertBefore(this._canvasContainer,t.nextSibling),this._resize(!0)}},{key:"_getContext",value:function(e){var t={antialias:this.getAttribute("antialias"),preserveDrawingBuffer:this.getAttribute("preserveDrawingBuffer")},n=e.getContext("webgl",t);if(n||(n=e.getContext("experimental-webgl",t)),!n)throw new Error("Failed to initializing WebGL context. Make sure your browser supporting WebGL.");return this._applyContextId(n)}},{key:"_applyContextId",value:function(e){var t=e;return t.__id__=Math.random().toString(36).slice(-6),t}},{key:"_isContainedInBody",value:function(e){return!!e.parentElement&&("BODY"===e.parentNode.nodeName||this._isContainedInBody(e.parentElement))}},{key:"_autoFixForBody",value:function(e){if("BODY"===e.parentElement.nodeName){0===document.body.getBoundingClientRect().height&&(document.body.style.height="100%",document.body.parentElement.style.height="100%")}}}]),t}(p.default);t.default=g,g.attributes={width:{default:"fit",converter:"CanvasSize"},height:{default:"fit",converter:"CanvasSize"},containerId:{default:"",converter:"String"},containerClass:{default:"gr-container",converter:"String"},preserveDrawingBuffer:{default:!0,converter:"Boolean"},antialias:{default:!0,converter:"Boolean"}}},function(e,t){e.exports="/*Header start*/\n// helper macros\n#ifdef FS\n  #define FS_PREC(prec,type) precision prec type;\n  #define VS_PREC(prec,type)\n  #ifdef GL_FRAGMENT_PRECISION_HIGH\n    #if GL_FRAGMENT_PRECISION_HIGH > 0\n      #define PREFER_HIGHP highp\n    #else\n      #define PREFER_HIGHP mediump\n    #endif\n  #endif\n  #ifndef GL_FRAGMENT_PRECISION_HIGH\n    #define PREFER_HIGHP mediump\n  #endif\n#endif\n#ifdef VS\n#define VS_PREC(prec,type) precision prec type;\n#define FS_PREC(prec,type)\n#endif\n// constants\n#define PI 3.141592653589793\n#define E 2.718281828459045\n#define LN2 0.6931471805599453\n#define LN10 2.302585092994046\n#define LOG2E 1.4426950408889634\n#define LOG10E 0.4342944819032518\n#define SQRT2 1.4142135623730951\n#define SQRT1_2 0.7071067811865476\n\n/*Header end*/\n"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(9),u=r(a),s=n(58),l=r(s),c=function(){function e(){o(this,e)}return i(e,null,[{key:"parse",value:function(t){var n=u.default.calcHash(t);return void 0!==e._parsedCache[n]?new Promise(function(t,r){t(e._parsedCache[n])}):e._parse(t).then(function(n){return e._parsedCache[t]=n,n})}},{key:"_parse",value:function(t){return new Promise(function(n,r){var o={};l.default.resolveImports(l.default.removeComment(t)).then(function(t){try{var i=l.default.separateTechniqueSource(t);for(var a in i)o[a]=e._parseTechnique(i[a]);n(o)}catch(e){r(e)}})})}},{key:"_parseTechnique",value:function(t){for(var n=l.default.fetchDrawOrder(t)||"Auto",r=l.default.separatePassSource(t),o=new Array(r.length),i=0;i<r.length;i++)o[i]=e._parsePassSource(r[i]);return{drawOrder:n,passes:o}}},{key:"_parsePassSource",value:function(e){var t=l.default.removePreferences(e);return{fragment:t,vertex:t,attributes:l.default.parseVariables(e,"attribute"),uniforms:l.default.parseVariables(e,"uniform"),macros:l.default.parseMacros(e),states:l.default.parsePreferences(e)}}}]),e}();c._parsedCache={},t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(59),u=r(a),s=n(60),l=r(s),c=n(62),f=r(c),d=n(63),h=r(d),p=n(64),_=r(p),v=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},y=function(){function e(){o(this,e)}return i(e,null,[{key:"separateTechniqueSource",value:function(t){if(-1===t.indexOf("@Technique"))return{default:t};for(var n={},r=/@Technique\s+([a-zA-Z0-9_]+)/g,o=void 0;o=r.exec(t);){var i=o[1];if(void 0!==n[i])throw new Error("Technique name "+i+" is dupelicated");n[i]=e.obtainNextSection(t,"{","}",o.index+o.length)}return n}},{key:"separatePassSource",value:function(t){if(-1===t.indexOf("@Pass"))return[t];for(var n=[],r=/@Pass/g,o=void 0;o=r.exec(t);)n.push(e.obtainNextSection(t,"{","}",o.index+o.length));return n}},{key:"fetchDrawOrder",value:function(e){var t=/@DrawOrder\s*\((\w+)\)/g.exec(e);if(t){var n=e.indexOf("@Pass");if(-1!==n&&n<t.index)throw new Error("DrawOrder preference should be just under @Technique section");return t[1]}return null}},{key:"removePreferences",value:function(e){var t=/@.+$/gm;return e.replace(t,"")}},{key:"resolveImports",value:function(t){return v(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=/\s*@import\s+"([^"]+)"/.exec(t)){n.next=4;break}return n.abrupt("break",17);case 4:return o=void 0,n.t0=e,n.next=8,l.default.resolve(r[1]);case 8:return n.t1=n.sent,n.next=11,n.t0.resolveImports.call(n.t0,n.t1);case 11:if("string"==typeof(o=n.sent)){n.next=14;break}throw new Error("Required shader chunk '"+r[1]+"' was not found!!");case 14:t=t.replace(r[0],"\n"+o+"\n"),n.next=0;break;case 17:return n.abrupt("return",t);case 18:case"end":return n.stop()}},n,this)}))}},{key:"parseMacros",value:function(e){for(var t={},n=/@ExposeMacro\s*\(\s*([a-zA-Z0-9_]+)\s*,\s*([a-zA-Z0-9_]+)\s*,\s*([a-zA-Z0-9_]+)\s*,\s*([a-zA-Z0-9_]+)\s*\)/g,r=void 0;r=n.exec(e);){if(!(r[1]&&r[2]&&r[3]&&r[4]))throw new Error("Invalid parameter was passed on @ExposeMacro preference on '"+r[0]+"'");if("bool"!==r[1]&&"int"!==r[1])throw new Error('Invalid macro type "'+r[1]+'". regexResult type must be int or bool');var o=void 0;if("bool"===r[1]){if("true"!==r[4]&&"false"!==r[4])throw new Error('Default macro value "'+r[4]+'" is invalid for bool type macro. Must be true or false');o="true"===r[4]}else if(o=parseFloat(r[4]),isNaN(o))throw new Error('Default macro value "'+r[4]+'" is invalid for int type macro. Must be a number.');t[r[2]]={name:r[2],macroName:r[3],type:r[1],value:o,target:"expose"}}for(n=/@ReferMacro\s*\(\s*([a-zA-Z0-9_]+)\s*,\s*(.+)\s*\)/g;r=n.exec(e);){if(!r[1]||!r[2])throw new Error("Invalid parameter was passed on @ReferMacro preference on '"+r[0]+"'");t[r[1]]={name:r[1],macroName:r[1],value:r[2],target:"refer"}}return t}},{key:"parsePreferences",value:function(e){for(var t={enable:[WebGLRenderingContext.CULL_FACE,WebGLRenderingContext.BLEND,WebGLRenderingContext.DEPTH_TEST],functions:{blendColor:[0,0,0,0],cullFace:[WebGLRenderingContext.BACK],blendFuncSeparate:[WebGLRenderingContext.ONE,WebGLRenderingContext.ZERO,WebGLRenderingContext.ONE,WebGLRenderingContext.ZERO],blendEquationSeparate:[WebGLRenderingContext.FUNC_ADD,WebGLRenderingContext.FUNC_ADD],lineWidth:[1],frontFace:[WebGLRenderingContext.CCW],depthRange:[0,1],depthFunc:[WebGLRenderingContext.LESS],depthMask:[!0],colorMask:[!0,!0,!0,!0]},dynamicState:[]},n=/@([A-Za-z]+)\(([\sa-zA-Z_0-9,\.\-]*)\)/g,r=void 0;r=n.exec(e);){var o=h.default[r[1]];if(!o)throw new Error("Unknown pass preference "+r[1]+" was specified.");o(t,r[2].split(",").map(function(e){return e.trim()}))}return t}},{key:"asValidJSON",value:function(e){var t=/([\{,]\s*)([a-zA-Z0-9_]+)(\s*\:)/gm;return e.replace(t,'$1"$2"$3')}},{key:"removeComment",value:function(e){return u.default.remove(e)}},{key:"obtainNextSection",value:function(e,t,n,r){var o=e.indexOf(t,r);if(-1===o)throw new Error("Begining section charactor '"+t+"' was not found.");if(t.length>1||n.length>1)throw new Error("Invalid parameter");for(var i=1,a=t.charCodeAt(0),u=n.charCodeAt(0),s=o+1;s<e.length;s++){var l=e.charCodeAt(s);if(l===a?i++:l===u&&i--,0===i)return e.substring(o+1,s)}throw new Error("Invalid bracket matching")}},{key:"generateVariableFetchRegex",value:function(e){return new RegExp("(?:@([a-zA-Z0-9_]+)?(\\{.+\\})?)?\\s*"+e+"\\s+(?:(lowp|mediump|highp)\\s+)?([a-z0-9A-Z]+)\\s+([a-zA-Z0-9_]+)(?:\\s*\\[\\s*([a-zA-Z0-9_]+)\\s*\\]\\s*)?\\s*;","g")}},{key:"parseVariables",value:function(t,n){for(var r={},o=e.generateVariableFetchRegex(n),i=void 0;i=o.exec(t);){var a=i[5],u=_.default[i[4]],s=i[3],l=i[2],c=void 0!==i[6],d=void 0,h=i[1];h||(h=f.default[n][a])||(h="uniform"===n?"USER_VALUE":a.toUpperCase()),c&&(d=parseInt(i[6],10),isNaN(d)&&(d=i[6])),r[a]={semantic:h,name:a,type:u,precision:s,attributes:l?JSON.parse(e.asValidJSON(l)):{},isArray:c,count:d}}return r}}]),e}();t.default=y},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(e){e[e.Default=0]="Default",e[e.SingleQuotationString=1]="SingleQuotationString",e[e.DoubleQuatationString=2]="DoubleQuatationString",e[e.MultilineComment=3]="MultilineComment",e[e.SinglelineComment=4]="SinglelineComment"}(o||(o={}));var a=function(){function e(t){r(this,e),this.source=t,this._status=o.Default,this._afterSlush=!1,this.removedSource=this._remove()}return i(e,[{key:"_remove",value:function(){for(var e="",t=void 0,n=0;n<this.source.length;n++){var r=this.source.charAt(n),i=this.source.charAt(n+1);if("\\"!==r){switch(this._status){case o.Default:this._defaultParsing(r,i)}switch(this._isInComment&&"\n"!==r||(e+=r),this._status){case o.MultilineComment:case o.SinglelineComment:this._checkCommentEnd(t,r)}t=r}else this._afterSlush=!0,n++}return e}},{key:"_defaultParsing",value:function(e,t){"'"===e&&(this._status=o.SingleQuotationString),'"'===e&&(this._status=o.DoubleQuatationString),"/"===e&&"/"===t&&(this._status=o.SinglelineComment),"/"===e&&"*"===t&&(this._status=o.MultilineComment)}},{key:"_checkCommentEnd",value:function(e,t){return"\n"===t&&this._status===o.SinglelineComment?void(this._status=o.Default):"*"===e&&"/"===t&&this._status===o.MultilineComment?void(this._status=o.Default):void 0}},{key:"_isInComment",get:function(){return this._status===o.MultilineComment||this._status===o.SinglelineComment}}],[{key:"remove",value:function(t){return new e(t).removedSource}}]),e}();t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ImportResolver=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(31),c=r(l),f=n(61),d=r(f),h=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},p=t.ImportResolver=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,function(e){return/^https?:\/\/.*/gm.test(e)?t._toAbsolute(e):e}));return e.staticImports=Object.assign({},d.default),e}return a(t,e),u(t,[{key:"resolve",value:function(e){var n=this;return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resolve",this).call(this,e,function(t){return n._resolve(e)})}},{key:"_resolve",value:function(e){return h(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!=typeof this.staticImports[e]){t.next=4;break}return t.abrupt("return",this.staticImports[e]);case 4:return t.next=6,this._fromExternal(e);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t,this)}))}},{key:"_fromExternal",value:function(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e),r.onload=function(e){t(r.responseText)},r.onerror=function(e){n(e)},r.send()})}}],[{key:"_toAbsolute",value:function(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host+t.pathname+t.search+t.hash}}]),t}(c.default);t.default=new p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(119),i=r(o),a=n(120),u=r(a);t.default={"basic-vert":i.default,"screen-vert":u.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={attribute:{position:"POSITION",normal:"NORMAL",texCoord:"TEXCOORD"},uniform:{_time:"TIME",_viewportSize:"VIEWPORT_SIZE",_matL:"LOCAL",_matM:"MODEL",_matV:"VIEW",_matP:"PROJECTION",_matVM:"MODELVIEW",_matPVM:"MODELVIEWPROJECTION",_matIM:"MODELINVERSE",_matIV:"VIEWINVERSE",_matIP:"PROJECTIONINVERSE",_matIVM:"MODELVIEWINVERSE",_matIPVM:"MODELVIEWPROJECTIONINVERSE",_matITM:"MODELINVERSETRANSPOSE",_matITVM:"MODELVIEWINVERSETRANSPOSE"}}},function(e,t,n){"use strict";function r(e,t){if(e.length!==t)throw new Error("Unmatching argument count on preference parse");return e.map(function(e){var t=WebGLRenderingContext[e];if("number"!=typeof t)throw new Error("Unknown WebGL constant "+e+" was specified");return t})}function o(e,t){if(e.length!==t)throw new Error("Unmatching argument count on preference parse");return e.map(function(e){var t=Number.parseFloat(e);if(isNaN(t))throw new Error("Failed to parse number on preference parsing");return t})}function i(e,t){if(e.length!==t)throw new Error("Unmatching argument count on preference parse");return e.map(function(e){if("true"!==e&&"false"!==e)throw new Error(e+" is not boolean");return"true"===e})}Object.defineProperty(t,"__esModule",{value:!0}),t.default={Enable:function(e,t){var n=WebGLRenderingContext[t[0]];if("number"!=typeof n)throw new Error('Unknown WebGL constant "'+t[0]+'" was specified on @Enable');e.enable.push(n)},Disable:function(e,t){var n=WebGLRenderingContext[t[0]];if("number"!=typeof n)throw new Error('Unknown WebGL constant "'+t[0]+'" was specified on @Disable');var r=e.enable.indexOf(n);-1!==r&&e.enable.splice(r,1)},BlendFunc:function(e,t){var n=r(t,2);e.functions.blendFuncSeparate=[n[0],n[1],n[0],n[1]]},BlendFuncSeparate:function(e,t){e.functions.blendFuncSeparate=r(t,4)},BlendEquation:function(e,t){var n=r(t,1);e.functions.blendEquationSeparate=[n[0],n[0]]},BlendEquationSeparate:function(e,t){e.functions.blendEquationSeparate=r(t,4)},BlendColor:function(e,t){e.functions.blendColor=o(t,4)},ColorMask:function(e,t){e.functions.colorMask=i(t,4),e.enable.push(WebGLRenderingContext.COLOR_WRITEMASK)},CullFace:function(e,t){e.functions.cullFace=r(t,1)},DepthFunc:function(e,t){e.functions.depthFunc=r(t,1)},DepthRange:function(e,t){e.functions.depthRange=o(t,2)},DepthMask:function(e,t){e.functions.depthMask=i(t,1)},FrontFace:function(e,t){e.functions.frontFace=r(t,1)},LineWidth:function(e,t){e.functions.lineWidth=o(t,1)},PolygonOffset:function(e,t){e.functions.polygonOffset=o(t,2),e.enable.push(WebGLRenderingContext.POLYGON_OFFSET_FILL)},Scissor:function(e,t){e.functions.scissor=o(t,4),e.enable.push(WebGLRenderingContext.SCISSOR_TEST)},ExposeMacro:function(){},ReferMacro:function(){},DynamicState:function(e,t){if(!t.length)throw new Error("DynamicState require at least 1 argument for specifying state resolver");var n=t[0];t.splice(0,1),e.dynamicState.push({stateResolver:n,args:t})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=WebGLRenderingContext;t.default={vec2:r.FLOAT_VEC2,vec3:r.FLOAT_VEC3,vec4:r.FLOAT_VEC4,ivec2:r.INT_VEC2,ivec3:r.INT_VEC3,ivec4:r.INT_VEC4,bvec2:r.BOOL_VEC2,bvec3:r.BOOL_VEC3,bvec4:r.BOOL_VEC4,float:r.FLOAT,int:r.INT,bool:r.BOOL,sampler2D:r.SAMPLER_2D,samplerCube:r.SAMPLER_CUBE,mat4:r.FLOAT_MAT4,mat3:r.FLOAT_MAT3,mat2:r.FLOAT_MAT2}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(66),a=function(e){return e&&e.__esModule?e:{default:e}}(i),u=function(){function e(){r(this,e),this._macro={},this._observers={};for(var t in a.default)this.setValue(t,a.default[t])}return o(e,[{key:"setValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===t&&(t=""),this._macro[e]!==t&&(this._macro[e]=t,this._observers[e]||(this._observers[e]=[]),this._notifyMacroChanged(e,t))}},{key:"getValue",value:function(e){var t=this._macro[e];return null===t?"":t}},{key:"watch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this._observers[e];r||(r=this._observers[e]=[]),r.push(t),n&&void 0!==this._macro[e]&&t(this._macro[e],!0)}},{key:"unwatch",value:function(e,t){var n=this._observers[e];if(!n)return!1;for(var r=0;r<n.length;r++)if(n[r]===t)return n.splice(r,1),!0}},{key:"_notifyMacroChanged",value:function(e,t){for(var n=0;n<this._observers[e].length;n++)this._observers[e][n](t,!1)}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={GRIMOIRE:null,WEBGL_VERSION:"1"}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(68),a=function(e){return e&&e.__esModule?e:{default:e}}(i),u=function(){function e(t,n){var o=this;r(this,e),this.material=t,this.passes=[],this.drawOrder=n.drawOrder,this.passes=n.passes.map(function(e){return new a.default(o,e)})}return o(e,[{key:"draw",value:function(e){for(var t=0;t<this.passes.length;t++)this.passes[t].draw(e)}},{key:"dispose",value:function(){this.passes.forEach(function(e){return e.dispose()})}}]),e}();t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(10),u=r(a),s=n(71),l=r(s),c=n(1),f=r(c),d=n(73),h=r(d),p=n(11),_=r(p),v=function(){function e(t,n){var r=this;o(this,e),this.technique=t,this.passRecipe=n,this.argumentDeclarations={},this.arguments={},this._macroHandlers={},this._uniformResolvers=_.default.generateRegisterers(this,n),this._gl=this.material.gl;var i=f.default.get(this._gl),a=i.macro;this._dynamicStateResolver=l.default.getDynamicStateResolver(this),this.program=new h.default(this._gl,n.vertex,n.fragment);for(var u in n.macros)!function(e){var t=n.macros[e];r.program.setMacro(t.macroName,t.value+""),"expose"===t.target?(r._macroHandlers[e]=function(e){var n=void 0;n="bool"===t.type?e?"":void 0:e,r.program.setMacro(t.macroName,n)},r.addArgument(e,{converter:"bool"===t.type?"Boolean":"Number",default:t.value})):"refer"===t.target&&(r.program.setMacro(t.macroName,t.value+""),a.watch(t.macroName,function(e,n){r.program.setMacro(t.macroName,e)},!0))}(u)}return i(e,[{key:"draw",value:function(e){var t=this.program.getProgram(e.geometry);t.use(),this._uniformResolvers.resolve(t.uniforms,e),l.default.configureForPass(this._gl,this.passRecipe),this._dynamicStateResolver(this._gl,e);for(var n in this.passRecipe.attributes){var r=this.passRecipe.attributes[n];u.default.bindBufferToAttribute(e.geometry,t,n,r.semantic)}u.default.drawWithCurrentVertexBuffer(e.geometry,e.indexGroup,e.drawCount,e.drawOffset)}},{key:"addArgument",value:function(e,t){if(this._argumentInitialized)throw new Error("setArgument cant be called for initialized pass");this.argumentDeclarations[e]=t}},{key:"setArgument",value:function(e,t,n){this._macroHandlers[e]?this._macroHandlers[e](t):this._uniformResolvers.update(this.program,e,t,n),this.arguments[e]=t}},{key:"dispose",value:function(){this._uniformResolvers.dispose(),this.program.dispose()}},{key:"material",get:function(){return this.technique.material}}]),e}();t.default=v},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS&&window.GrimoireJS.lib.math?window.GrimoireJS.lib.math.AABB:void 0},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},s=n(4),l=function(e){return e&&e.__esModule?e:{default:e}}(s),c=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:WebGLRenderingContext.ARRAY_BUFFER,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:WebGLRenderingContext.STATIC_DRAW;r(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,e.createBuffer()));return a.target=n,a.usage=i,a.keepSource=!1,a._bufferSource=null,a}return i(t,e),a(t,[{key:"update",value:function(e,t){this.bind(),this._bufferSource=null,t?(this.valid||this.gl.bufferData(this.target,e+t.byteLength,this.usage),this.gl.bufferSubData(this.target,e,t)):"number"==typeof e?this.gl.bufferData(this.target,e,this.usage):(this.gl.bufferData(this.target,e,this.usage),this._bufferSource=e),this.valid=!0}},{key:"bind",value:function(){this.gl.bindBuffer(this.target,this.resourceReference)}},{key:"destroy",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this._bufferSource=null,this.gl.deleteBuffer(this.resourceReference)}},{key:"bufferSource",get:function(){if(this.keepSource)return this._bufferSource;throw new Error("Accessing bufferSource getter of Buffer class instance require keepSource flag being enabled before updating Buffer.")}}]),t}(l.default);t.default=c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(72),a=function(e){return e&&e.__esModule?e:{default:e}}(i),u=function(){function e(){r(this,e)}return o(e,null,[{key:"registerDynamicStateResolver",value:function(t,n){e._dynamicStateResolvers[t]=n}},{key:"getDynamicStateResolver",value:function(t){if(t.passRecipe.states.dynamicState){for(var n=t.passRecipe.states.dynamicState,r=[],o=0;o<n.length;o++){var i=n[o],a=e._dynamicStateResolvers[i.stateResolver];if(!a)throw new Error("Unknown dynamic state resolver '"+i.stateResolver+"' was required");r.push(a(i.args,t))}return function(e,t){return r.forEach(function(n){return n(e,t)})}}return function(){}}},{key:"configureForPass",value:function(t,n){var r=n.states,o=r.functions;r.disable||e.complementDisableState(n.states);for(var i=0;i<r.enable.length;i++)t.enable(r.enable[i]);for(var a=0;a<r.disable.length;a++)t.disable(r.disable[a]);o.blendColor&&t.blendColor(o.blendColor[0],o.blendColor[1],o.blendColor[2],o.blendColor[3]),o.blendEquationSeparate&&t.blendEquationSeparate(o.blendEquationSeparate[0],o.blendEquationSeparate[1]),o.blendFuncSeparate&&t.blendFuncSeparate(o.blendFuncSeparate[0],o.blendFuncSeparate[1],o.blendFuncSeparate[2],o.blendFuncSeparate[3]),o.colorMask&&t.colorMask(o.colorMask[0],o.colorMask[1],o.colorMask[2],o.colorMask[3]),o.cullFace&&t.cullFace(o.cullFace[0]),o.depthFunc&&t.depthFunc(o.depthFunc[0]),o.depthMask&&t.depthMask(o.depthMask[0]),o.depthRange&&t.depthRange(o.depthRange[0],o.depthRange[1]),o.frontFace&&t.frontFace(o.frontFace[0]),o.polygonOffset&&t.polygonOffset(o.polygonOffset[0],o.polygonOffset[1]),o.scissor&&t.scissor(o.scissor[0],o.scissor[1],o.scissor[2],o.scissor[3])}},{key:"complementDisableState",value:function(t){t.disable||(t.disable=[]);var n=!0,r=!1,o=void 0;try{for(var i,a=e._glEnableTargets[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var u=i.value;-1===t.enable.indexOf(u)&&t.disable.push(u)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}}]),e}();t.default=u,u._glEnableTargets=[WebGLRenderingContext.CULL_FACE,WebGLRenderingContext.DEPTH_TEST,WebGLRenderingContext.STENCIL_TEST,WebGLRenderingContext.BLEND,WebGLRenderingContext.SCISSOR_TEST,WebGLRenderingContext.DITHER,WebGLRenderingContext.POLYGON_OFFSET_FILL,WebGLRenderingContext.SAMPLE_ALPHA_TO_COVERAGE,WebGLRenderingContext.SAMPLE_COVERAGE],u._dynamicStateResolvers=Object.assign({},a.default)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={"dynamic-cull":function(e,t){function n(e){o!==e&&t.program.setMacro("CONTEXT_STATE_CULL",e)}var r=e[1]||"cull";t.addArgument(r,{converter:"String",default:e[0]||"back"});var o=null;return function(e){if("none"!==t.arguments[r])if(e.enable(WebGLRenderingContext.CULL_FACE),"back"===t.arguments[r])e.cullFace(WebGLRenderingContext.BACK),n("1");else{if("front"!==t.arguments[r])throw new Error("Unknown culling mode");e.cullFace(WebGLRenderingContext.FRONT),n("2")}else e.disable(WebGLRenderingContext.CULL_FACE),n("0")}}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(74),u=r(a),s=n(78),l=r(s),c=n(80),f=r(c),d=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};o(this,e),this._gl=t,this._vsSource=n,this._fsSource=r,this._macros=i,this._programs={},this._shaders=[]}return i(e,[{key:"getProgram",value:function(e){return this._programs[e.accessorHash]?this._programs[e.accessorHash]:this._constructProgram(e)}},{key:"setMacro",value:function(e,t){this._macros[e]!==t&&(this._macros[e]="boolean"==typeof t?t?"":void 0:t,this.dispose())}},{key:"dispose",value:function(){for(var e in this._programs)this._programs[e].release();this._programs={},this._shaders.forEach(function(e){return e.release()}),this._shaders=[]}},{key:"_constructProgram",value:function(e){var t=l.default.getShader(this._gl,WebGLRenderingContext.FRAGMENT_SHADER,f.default.generate(WebGLRenderingContext.FRAGMENT_SHADER,this._macros,this._fsSource,e)),n=l.default.getShader(this._gl,WebGLRenderingContext.VERTEX_SHADER,f.default.generate(WebGLRenderingContext.VERTEX_SHADER,this._macros,this._vsSource,e)),r=u.default.getProgram(this._gl,[n,t]);return this._shaders.push(t),this._shaders.push(n),this._programs[e.accessorHash]=r,r}},{key:"macros",get:function(){return this._macros},set:function(e){this._macros=e,this.dispose()}},{key:"fragmentShader",get:function(){return this._fsSource},set:function(e){this._fsSource=e,this.dispose()}},{key:"vertexShader",get:function(){return this._vsSource},set:function(e){this._vsSource=e,this.dispose()}}]),e}();t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(9),l=r(s),c=n(75),f=r(c),d=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.hash=n,r._referenceCount=0,r}return a(t,e),u(t,[{key:"release",value:function(){0===--this._referenceCount&&(this.destroy(),t._managedPrograms.get(this.gl)[this.hash]=void 0)}}],[{key:"getProgram",value:function(e,n){t._managedPrograms.has(e)||t._managedPrograms.set(e,{});var r=t._managedPrograms.get(e),o="";n=n.sort(),n.forEach(function(e){o+=e.index+","});var i=l.default.calcHash(o);return void 0===r[i]&&(r[i]=new t(e,i),r[i].update(n)),r[i]._referenceCount++,r[i]}}]),t}(f.default);t.default=d,d._managedPrograms=new Map},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(4),c=r(l),f=n(76),d=r(f),h=n(77),p=r(h),_=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,e.createProgram()));return n._uniformLocations={},n._attributeLocations={},n.uniforms=new p.default(n),n}return a(t,e),u(t,[{key:"update",value:function(e){var t=this;if(this.valid){this.gl.getAttachedShaders(this.resourceReference).forEach(function(e){return t.gl.detachShader(t.resourceReference,e)})}if(this._uniformLocations={},this._attributeLocations={},e.forEach(function(e){t.gl.attachShader(t.resourceReference,e.resourceReference)}),this.gl.linkProgram(this.resourceReference),!this.gl.getProgramParameter(this.resourceReference,WebGLRenderingContext.LINK_STATUS)){var n=this.gl.getProgramInfoLog(this.resourceReference);throw new Error("LINK FAILED\n"+n)}this.valid=!0}},{key:"use",value:function(){this.isLastUsed||this.gl.useProgram(this.resourceReference),this.uniforms.onUse()}},{key:"destroy",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.gl.deleteProgram(this.resourceReference),this._uniformLocations={},this._attributeLocations={}}},{key:"findAttributeLocation",value:function(e){return void 0===this._attributeLocations[e]?(this._attributeLocations[e]=this.gl.getAttribLocation(this.resourceReference,e),this._safeEnableVertexAttribArray(this._attributeLocations[e]),this._attributeLocations[e]):this._attributeLocations[e]}},{key:"findUniformLocation",value:function(e){var t=this._uniformLocations[e];return void 0===t?this._uniformLocations[e]=this.gl.getUniformLocation(this.resourceReference,e):t}},{key:"_safeEnableVertexAttribArray",value:function(e){e<0||this.gl.enableVertexAttribArray(e)}},{key:"isLastUsed",get:function(){return d.default.useProgramCheck(this.gl,this.resourceReference)}}]),t}(c.default);t.default=_},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=t.ResourceCache=function(){function e(){r(this,e),this._lastUsedPrograms=new Map}return o(e,[{key:"useProgramCheck",value:function(e,t){return this._lastUsedPrograms.get(e)===t||(this._lastUsedPrograms.set(e,t),!1)}}]),e}();t.default=new i},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=new Float32Array(9),a=function(){function e(t){r(this,e),this.program=t,this._currentTextureRegister=0,this._gl=t.gl}return o(e,[{key:"uniformBool",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform1i(e,t?1:0)})}},{key:"uniformMatrix",value:function(e,t){var n=this;this._pass(e,function(e){n._gl.uniformMatrix4fv(e,!1,t.rawElements)})}},{key:"uniformMatrix3",value:function(e,t){var n=this;this._pass(e,function(e){for(var r=t.rawElements,o=0;o<3;o++)i[3*o+0]=r[4*o+0],i[3*o+1]=r[4*o+1],i[3*o+2]=r[4*o+2];n._gl.uniformMatrix3fv(e,!1,i)})}},{key:"uniformMatrixArray",value:function(e,t){for(var n=this,r=t.length/16,o=0;o<r;o++)!function(r){n._passAsArray(e,r,function(e){return n._gl.uniformMatrix4fv(e,!1,new Float32Array(t.buffer,t.byteOffset+64*r))})}(o)}},{key:"uniformFloat",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform1f(e,t)})}},{key:"uniformFloatArray",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform1fv(e,t)})}},{key:"uniformInt",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform1i(e,t)})}},{key:"uniformVector2",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform2f(e,t.X,t.Y)})}},{key:"uniformIntVector2",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform2i(e,t.X,t.Y)})}},{key:"uniformVector2Array",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform2fv(e,t)})}},{key:"uniformVector3",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform3f(e,t.X,t.Y,t.Z)})}},{key:"uniformIntVector3",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform3i(e,t.X,t.Y,t.Z)})}},{key:"uniformVector3Array",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform3fv(e,t)})}},{key:"uniformColor3",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform3f(e,t.R,t.G,t.B)})}},{key:"uniformVector4",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform4f(e,t.X,t.Y,t.Z,t.W)})}},{key:"uniformIntVector4",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform4f(e,t.X,t.Y,t.Z,t.W)})}},{key:"uniformVector4Array",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform4fv(e,t)})}},{key:"uniformColor4",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform4f(e,t.R,t.G,t.B,t.A)})}},{key:"uniformTexture2D",value:function(e,t){t.valid?(t.register(this._currentTextureRegister),this.uniformInt(e,this._currentTextureRegister),this._currentTextureRegister++):console.warn("The texture assigned to '"+e+"' is not valid.")}},{key:"onUse",value:function(){this._currentTextureRegister=0}},{key:"_pass",value:function(e,t){var n=this.program.findUniformLocation(e);n&&t(n)}},{key:"_passAsArray",value:function(e,t,n){var r=this.program.findUniformLocation(e+"["+t+"]");r&&n(r)}}]),e}();t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(9),l=r(s),c=n(79),f=r(c),d=function(e){function t(e,n,r,a){o(this,t);var u=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r));return u.type=n,u.sourceCode=r,u.hash=a,u._referenceCount=0,u}return a(t,e),u(t,[{key:"release",value:function(){0===--this._referenceCount&&(this.destroy(),t._managedShaders.get(this.gl)[this.hash]=void 0)}}],[{key:"getShader",value:function(e,n,r){t._managedShaders.has(e)||t._managedShaders.set(e,{});var o=t._managedShaders.get(e),i=l.default.calcHash(r+n);return void 0===o[i]&&(o[i]=new t(e,n,r,i)),o[i]._referenceCount++,o[i]}}]),t}(f.default);t.default=d,d._managedShaders=new Map},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},s=n(4),l=function(e){return e&&e.__esModule?e:{default:e}}(s),c=function(e){function t(e,n,i){r(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,e.createShader(n)));return a.type=n,a.sourceCode=i,i&&a.update(i),a}return i(t,e),a(t,[{key:"update",value:function(e){if(this.gl.shaderSource(this.resourceReference,e),this.gl.compileShader(this.resourceReference),!this.gl.getShaderParameter(this.resourceReference,WebGLRenderingContext.COMPILE_STATUS))throw new Error("Compiling shader failed.\nSourceCode:\n"+this._insertLineNumbers(e)+"\n\nErrorCode:"+this.gl.getShaderInfoLog(this.resourceReference));this.sourceCode=e,this.valid=!0}},{key:"destroy",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.gl.deleteShader(this.resourceReference)}},{key:"_insertLineNumbers",value:function(e){e="1:"+e;for(var t=2,n=0;n<e.length;n++){"\n"===e.charAt(n)&&(e=e.substring(0,n+1)+(t+":")+e.substring(n+1,e.length),n++,t++)}return e}}]),t}(l.default);t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(56),u=r(a),s=n(81),l=r(s),c=function(){function e(){o(this,e)}return i(e,null,[{key:"generate",value:function(t,n,r,o){return""+(t===WebGLRenderingContext.VERTEX_SHADER?"#define VS\n":"#define FS\n")+this._precisionCode(o.gl)+e._geometryToAttributeUsedFlags(o)+e._macroCode(n)+u.default+"\n/*****BEGINNING OF USER CODE******/\n"+r}},{key:"_macroCode",value:function(e){var t="";for(var n in e)void 0!==e[n]&&(t+="#define "+n+" "+e[n]+"\n");return t}},{key:"_geometryToAttributeUsedFlags",value:function(e){var t="";for(var n in e.accessors)t+="#define ATTRIBUTE_"+n+"_ENABLED\n";return t}},{key:"_precisionCode",value:function(t){var n="",r=l.default.get(t);return n+=e._precisionChunk(r.vertexInteger,"VERTEX_INTEGER",!1),n+=e._precisionChunk(r.fragmentInteger,"FRAGMENT_INTEGER",!1),n+=e._precisionChunk(r.vertexFloat,"VERTEX_FLOAT",!0),n+=e._precisionChunk(r.fragmentFloat,"FRAGMENT_FLOAT",!0)}},{key:"_precisionChunk",value:function(t,n,r){return e._precisionForVariable(t.lowp,n+"_LOWP",r)+e._precisionForVariable(t.mediump,n+"_MEDIUMP",r)+e._precisionForVariable(t.highp,n+"_HIGHP",r)}},{key:"_precisionForVariable",value:function(e,t,n){return"#define VARIABLE_MIN_"+t+" "+e.rangeMin+"\n#define VARIABLE_MAX_"+t+" "+e.rangeMax+"\n"+(n?"#define VARIABLE_PRECISION_"+t+" "+e.precision+" \n":"")}}]),e}();t.default=c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(3),s=function(e){return e&&e.__esModule?e:{default:e}}(u),l=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.gl=e,n.vertexInteger={lowp:e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.LOW_INT),mediump:e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_INT),highp:e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_INT)},n.fragmentInteger={lowp:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.LOW_INT),mediump:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_INT),highp:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_INT)},n.vertexFloat={lowp:e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.LOW_FLOAT),mediump:e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT),highp:e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT)},n.fragmentFloat={lowp:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.LOW_FLOAT),mediump:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT),highp:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT)},n}return i(t,e),a(t,null,[{key:"get",value:function(e){return this.__get(e,t)}}]),t}(s.default);t.default=l,l.registryName="GLSLPrecisionChecker"},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,n,o){r(this,e),this.registerers=t,this.disposers=n,this.updators=o}return o(e,[{key:"resolve",value:function(e,t){this.registerers.forEach(function(n){return n(e,t)})}},{key:"dispose",value:function(){this.disposers.forEach(function(e){return e()})}},{key:"update",value:function(e,t,n,r){this.updators[t]&&this.updators[t](e,n,r)}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(12),c=r(l),f=n(4),d=r(f),h=n(38),p=r(h),_=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,e.createTexture()));return r.textureType=n,r.__format=WebGLRenderingContext.RGBA,r.__type=WebGLRenderingContext.UNSIGNED_BYTE,r._texParameterChanged=!0,r._magFilter=WebGLRenderingContext.LINEAR,r._minFilter=WebGLRenderingContext.LINEAR,r._wrapS=WebGLRenderingContext.REPEAT,r._wrapT=WebGLRenderingContext.REPEAT,r}return a(t,e),u(t,[{key:"destroy",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.gl.deleteTexture(this.resourceReference)}},{key:"register",value:function(e){this.gl.activeTexture(WebGLRenderingContext.TEXTURE0+e),this.gl.bindTexture(this.textureType,this.resourceReference),this.__applyTexParameter()}},{key:"__getRawPixels",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments[4],i=arguments[5],a=arguments[6],u=p.default.typeToTypedArrayConstructor(e),s=new u(o*i*p.default.formatToElementCount(t)),l=this.gl.createFramebuffer();return this.gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,l),this.gl.framebufferTexture2D(WebGLRenderingContext.FRAMEBUFFER,WebGLRenderingContext.COLOR_ATTACHMENT0,a,this.resourceReference,0),this.gl.checkFramebufferStatus(WebGLRenderingContext.FRAMEBUFFER)===WebGLRenderingContext.FRAMEBUFFER_COMPLETE&&this.gl.readPixels(n,r,o,i,t,e,s),this.gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),s}},{key:"__ensurePOT",value:function(e){if(e instanceof HTMLImageElement)return this._ensureImagePOT(e);if(e instanceof HTMLCanvasElement)return this._ensureCanvasPOT(e);if(e instanceof HTMLVideoElement)return this._ensureVideoPOT(e);throw new Error("Unsupported resource type")}},{key:"__needMipmap",value:function(e){return t._filtersNeedsMipmap.indexOf(e)>-1}},{key:"__applyTexParameter",value:function(){this._texParameterChanged&&(this.gl.texParameteri(this.textureType,WebGLRenderingContext.TEXTURE_MIN_FILTER,this._minFilter),this.gl.texParameteri(this.textureType,WebGLRenderingContext.TEXTURE_MAG_FILTER,this._magFilter),this.gl.texParameteri(this.textureType,WebGLRenderingContext.TEXTURE_WRAP_S,this._wrapS),this.gl.texParameteri(this.textureType,WebGLRenderingContext.TEXTURE_WRAP_T,this._wrapT),this._texParameterChanged=!1)}},{key:"_ensureImagePOT",value:function(e){var t=e.naturalWidth,n=e.naturalHeight,r=c.default.getPow2Size(t,n);return t!==r.width||n!==r.height?{result:this._resizeImageOrVideo(e,r.width,r.height),height:r.height,width:r.width}:{result:e,width:t,height:n}}},{key:"_ensureCanvasPOT",value:function(e){var t=e.width,n=e.height,r=c.default.getPow2Size(t,n);return t!==r.width||n!==r.height?(e.width=r.width,e.height=r.height,{result:e,width:e.width,height:e.height}):{result:e,width:e.width,height:e.height}}},{key:"_ensureVideoPOT",value:function(e){var t=e.videoWidth,n=e.videoHeight,r=c.default.getPow2Size(t,n);return t!==r.width||n!==r.height?{result:this._resizeImageOrVideo(e,r.width,r.height),width:r.width,height:r.height}:{result:e,width:t,height:n}}},{key:"_resizeImageOrVideo",value:function(e,n,r){var o=t._resizerCanvas;return o.height=r,o.width=n,t._resizerContext.drawImage(e,0,0,e.width,e.height,0,0,n,r),t._resizerCanvas}},{key:"magFilter",get:function(){return this._magFilter},set:function(e){this._magFilter!==e&&(this._texParameterChanged=!0,this._magFilter=e)}},{key:"minFilter",get:function(){return this._minFilter},set:function(e){this._minFilter!==e&&(this._texParameterChanged=!0,this._minFilter=e,this.__ensureMipmap())}},{key:"wrapS",get:function(){return this._wrapS},set:function(e){this._wrapS!==e&&(this._texParameterChanged=!0,this._wrapS=e)}},{key:"wrapT",get:function(){return this._wrapT},set:function(e){this._wrapT!==e&&(this._texParameterChanged=!0,this._wrapT=e)}},{key:"format",get:function(){return this.__format}},{key:"type",get:function(){return this.__type}}]),t}(d.default);t.default=_,_._resizerCanvas=document.createElement("canvas"),_._resizerContext=_._resizerCanvas.getContext("2d"),_._filtersNeedsMipmap=[WebGLRenderingContext.LINEAR_MIPMAP_LINEAR,WebGLRenderingContext.LINEAR_MIPMAP_NEAREST,WebGLRenderingContext.NEAREST_MIPMAP_LINEAR,WebGLRenderingContext.NEAREST_MIPMAP_NEAREST]},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS&&window.GrimoireJS.lib.math?window.GrimoireJS.lib.math.Rectangle:void 0},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),s=function(e){return e&&e.__esModule?e:{default:e}}(u),l=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._fullscreen=!1,e}return i(t,e),a(t,[{key:"$awake",value:function(){var e=this;this.getAttributeRaw("fullscreen").watch(function(t){e._fullscreen!==t&&(e._fullscreen=t,e._switchFullscreen())})}},{key:"_switchFullscreen",value:function(){if(this._fullscreen){var e=this.getAttribute("fullscreenTarget");if(e){var t=document.querySelectorAll(e);t[0]?this.requestFullscreen(t[0]):console.warn("Specified fullscreenTarget was not found on HTML dom tree")}else this.requestFullscreen(this.companion.get("canvasContainer"))}else this.exitFullscreen()}},{key:"requestFullscreen",value:function(e){if(e.webkitRequestFullscreen)e.webkitRequestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else if(e.msRequestFullscreen)e.msRequestFullscreen();else{if(!e.requestFullscreen)return void console.error("");e.requestFullscreen()}}},{key:"exitFullscreen",value:function(){document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.cancelFullScreen?document.cancelFullScreen():document.exitFullscreen&&document.exitFullscreen()}}]),t}(s.default);t.default=l,l.attributes={fullscreen:{converter:"Boolean",default:!1},fullscreenTarget:{converter:"String",default:null}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),l=r(s),c=n(21),f=r(c),d=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},h=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$mount",value:function(){return d(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,o,i,a,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.getAttribute("type"))){e.next=15;break}n=f.default.get(this.companion.get("gl")),r=f.default.factoryArgumentDeclarations[t],o={};for(i in r)this.__addAttribute(i,r[i]),o[i]=this.getAttribute(i);if(a=n.instanciate(t,o),u=this.companion.get("GeometryRegistory"),s=this.getAttribute("name")){e.next=11;break}throw new Error("Name was not specified");case 11:return u.addGeometry(s,a),e.next=14,a;case 14:this.geometry=e.sent;case 15:case"end":return e.stop()}},e,this)}))}}]),t}(l.default);t.default=h,h.attributes={type:{converter:"String",default:null},name:{converter:"String",default:null}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),l=r(s),c=n(14),f=r(c),d=n(21),h=r(d),p=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._geometryResolver=new f.default,e}return a(t,e),u(t,[{key:"$awake",value:function(){this.companion.set(this.name,this);var e=h.default.get(this.companion.get("gl")),t=!0,n=!1,r=void 0;try{for(var o,i=this.getAttribute("defaultGeometry")[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this.addGeometry(a,e.instanciateAsDefault(a))}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}},{key:"addGeometry",value:function(e,t){this._geometryResolver.register(e,t)}},{key:"getGeometry",value:function(e){return this._geometryResolver.get(e)}}]),t}(l.default);t.default=p,p.attributes={defaultGeometry:{converter:"StringArray",default:["quad","cube","sphere"]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={Background:{priorty:1e3},NoAlpha:{priorty:2e3},UseAlpha:{priorty:3e3,descending:!0},NoDepth:{priorty:4e3,descending:!0},Overlay:{priorty:5e3,descending:!0}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),l=r(s),c=n(14),f=r(c),d=n(1),h=r(d),p=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){if(this.getAttributeRaw("typeName").watch(function(){console.warn("Changeing 'typeName' on MaterialImporter makes no sense. This change won't affect anything.")}),this.getAttributeRaw("src").watch(function(){console.warn("Changeing 'src' on MaterialImporter makes no sense. This change won't affect anything.")}),!this.getAttribute("typeName")||!this.getAttribute("src"))throw new Error("type or src cannot be null in material importer");var e=this.getAttribute("typeName");if(h.default.getMaterialStatus(e)!==f.default.UNLOADED)throw new Error("A material type '"+e+"' is already loaded.");h.default.addSORTMaterialFromURL(this.getAttribute("typeName"),this.getAttribute("src"))}}]),t}(l.default);t.default=p,p.attributes={typeName:{default:null,converter:"String"},src:{default:null,converter:"String"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(5),l=r(s),c=n(36),f=r(c),d=n(0),h=r(d),p=n(22),_=r(p),v=n(19),y=r(v),b=n(8),m=r(b),g=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},w=f.default.vec3,E=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.renderArgs={},e._priortyCalcCache=new Float32Array(3),e}return a(t,e),u(t,[{key:"getRenderingPriorty",value:function(e,t){return this.geometryInstance&&this._materialContainer.material.techniques[t]?(w.add(this._priortyCalcCache,e.transform.globalPosition.rawElements,this.geometryInstance.aabb.Center.rawElements),w.sub(this._priortyCalcCache,this._priortyCalcCache,this._transformComponent.globalPosition.rawElements),this._materialContainer.getDrawPriorty(w.sqrLen(this._priortyCalcCache),t)):Number.NEGATIVE_INFINITY}},{key:"$awake",value:function(){var e=this;this.__bindAttributes(),this.getAttributeRaw("geometry").watch(function(){return g(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.geometry;case 2:this.geometryInstance=e.sent;case 3:case"end":return e.stop()}},e,this)}))},!0)}},{key:"$mount",value:function(){this._transformComponent=this.node.getComponent(m.default),this._materialContainer=this.node.getComponent(_.default),this._containedScene=t._findContainedScene(this.node),this._containedScene.queueRegistory.addRenderable(this)}},{key:"$unmount",value:function(){this._containedScene.queueRegistory.removeRenderable(this)}},{key:"render",value:function(e){if(this.node.isActive&&this.enabled&&this.layer===e.layer&&this.geometryInstance&&(e.material||this._materialContainer.material)){var t={indexGroup:this.indexGroup,geometry:this.geometryInstance,camera:e.camera,transform:this._transformComponent,viewport:e.viewport,drawCount:this.drawCount,drawOffset:this.drawOffset,sceneDescription:e.sceneDescription,rendererDescription:e.rendererDescription,technique:e.technique,renderable:this};l.default.debug&&window.spector&&window.spector.setMarker("Mesh renderer:"+this.node.id),this._materialContainer.material.draw(t),this.node.emit("render",e)}}},{key:"setRenderableIndex",value:function(e){this.index=e}}],[{key:"_findContainedScene",value:function(e){if(e.parent){var n=e.parent.getComponent(y.default);return n||t._findContainedScene(e.parent)}return null}}]),t}(h.default);t.default=E,E.attributes={geometry:{converter:"Geometry",default:"quad"},indexGroup:{converter:"String",default:"default"},layer:{converter:"String",default:"default"},drawCount:{converter:"Number",default:Number.MAX_VALUE},drawOffset:{converter:"Number",default:0}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(17),l=r(s),c=n(121),f=r(c),d=n(7),h=r(d),p=n(0),_=r(p),v=n(8),y=r(v),b=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._updated=!1,e._lastCenter=null,e._lastScreenPos=null,e._lastPinchDistance=null,e._xsum=0,e._ysum=0,e._d=h.default.Zero,e}return a(t,e),u(t,[{key:"$awake",value:function(){this.__bindAttributes(),this._listeners={mousemove:this._mouseMove.bind(this),touchmove:this._touchMove.bind(this),touchstart:this._touchStart.bind(this),touchend:this._touchEnd.bind(this),contextmenu:this._contextMenu.bind(this),wheel:this._mouseWheel.bind(this)}}},{key:"$mount",value:function(){this._transform=this.node.getComponent(y.default);var e=this.companion.get("canvasElement");e.addEventListener("mousemove",this._listeners.mousemove),e.addEventListener("touchmove",this._listeners.touchmove),e.addEventListener("touchstart",this._listeners.touchstart),e.addEventListener("touchend",this._listeners.touchend),e.addEventListener("contextmenu",this._listeners.contextmenu),e.addEventListener("wheel",this._listeners.wheel),this._lastScreenPos=null,this._xsum=0,this._ysum=0}},{key:"$unmount",value:function(){var e=this.companion.get("canvasElement");e.removeEventListener("mousemove",this._listeners.mousemove),e.removeEventListener("touchmove",this._listeners.touchmove),e.removeEventListener("touchstart",this._listeners.touchstart),e.removeEventListener("touchend",this._listeners.touchend),e.removeEventListener("contextmenu",this._listeners.contextmenu),e.removeEventListener("wheel",this._listeners.wheel)}},{key:"$initialized",value:function(){var e=h.default.normalize(this.center.subtractWith(this._transform.position)),t=f.default.fromToRotation(this._transform.forward,e).normalize();this._transform.rotation=t,this._initialRotation=t,this._initialDirection=h.default.copy(this._transform.forward.negateThis()).normalized,null!==this.distance?this._transform.position=this.center.addWith(this._initialDirection.multiplyWith(this.distance)):this.distance=this._transform.position.subtractWith(this.center).magnitude}},{key:"$update",value:function(){if(this.isActive&&this._updated||!this._lastCenter||!this.center.equalWith(this._lastCenter)){this._updated=!1,this._lastCenter=this.center;var e=f.default.angleAxis(-this._xsum*this.rotateSpeed*.01,h.default.YUnit),t=f.default.angleAxis(-this._ysum*this.rotateSpeed*.01,h.default.XUnit),n=f.default.multiply(e,t),r=l.default.rotationQuaternion(n),o=l.default.transformNormal(r,this._initialDirection);this._transform.position=this.center.addWith(this._d).addWith(h.default.normalize(o).multiplyWith(this.distance)),this._transform.rotation=n,this._transform.rotation=f.default.multiply(n,this._initialRotation)}}},{key:"_contextMenu",value:function(e){this.isActive&&e.preventDefault()}},{key:"_touchStart",value:function(e){this.isActive&&(e.touches.length>=2&&(this._lastPinchDistance=Math.pow(Math.pow(e.touches[0].pageX-e.touches[1].pageX,2)+Math.pow(e.touches[0].pageY-e.touches[1].pageY,2),.5)),this._lastScreenPos=null,e.preventDefault())}},{key:"_touchEnd",value:function(e){this.isActive}},{key:"_mouseMove",value:function(e){if(this.isActive){var t=e.screenX,n=e.screenY;if(null===this._lastScreenPos)return void(this._lastScreenPos={x:t,y:n});this._checkButtonPress(e,!1)?(e.preventDefault(),this._move(t,n)):this._checkButtonPress(e,!0)&&(e.preventDefault(),this._rotate(t,n)),this._lastScreenPos={x:t,y:n}}}},{key:"_touchMove",value:function(e){if(this.isActive)switch(e.touches.length){case 1:var t=e.touches[0].pageX,n=e.touches[0].pageY;if(null===this._lastScreenPos)return void(this._lastScreenPos={x:t,y:n});e.preventDefault(),this._rotate(t,n),this._lastScreenPos={x:t,y:n};break;case 2:this.getAttribute("preventScroll")&&e.preventDefault();var r=Math.pow(Math.pow(e.touches[0].pageX-e.touches[1].pageX,2)+Math.pow(e.touches[0].pageY-e.touches[1].pageY,2),.5);this._zoom(.5*(this._lastPinchDistance-r)),this._lastPinchDistance=r}}},{key:"_mouseWheel",value:function(e){this.isActive&&(this.getAttribute("preventScroll")&&e.preventDefault(),this._zoom(e.deltaY))}},{key:"_checkButtonPress",value:function(e,t){return"buttons"in e?t?(1&e.buttons)>0:(2&e.buttons)>0:t?1===e.which:3===e.which}},{key:"_move",value:function(e,t){var n=e-this._lastScreenPos.x,r=t-this._lastScreenPos.y,o=-n*this.moveSpeed*.01,i=r*this.moveSpeed*.01;this._d=this._d.addWith(this._transform.right.multiplyWith(o)).addWith(this._transform.up.multiplyWith(i)),this._updated=!0}},{key:"_rotate",value:function(e,t){var n=e-this._lastScreenPos.x,r=t-this._lastScreenPos.y;this._xsum+=n,this._ysum+=r,this._ysum=Math.min(50*Math.PI,this._ysum),this._ysum=Math.max(50*-Math.PI,this._ysum),this._updated=!0}},{key:"_zoom",value:function(e){var t=h.default.subtract(this._transform.position,this.center).normalized,n=e*this.zoomSpeed*.05;this.distance=Math.max(1,this.distance+n),this._transform.position=this.center.addWith(t.multiplyWith(this.distance))}}]),t}(_.default);t.default=b,b.attributes={rotateSpeed:{default:1,converter:"Number"},zoomSpeed:{default:1,converter:"Number"},moveSpeed:{default:1,converter:"Number"},center:{default:"0,0,0",converter:"Position",lazy:!0},distance:{default:null,converter:"Number"},preventScroll:{default:!0,converter:"Boolean"}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(41),s=function(e){return e&&e.__esModule?e:{default:e}}(u),l=function(e){function t(e){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),a(t,[{key:"setViewport",value:function(e){this._viewport=e}},{key:"getViewport",value:function(){return this._viewport}},{key:"__configureClearScissor",value:function(){this.gl.enable(WebGLRenderingContext.SCISSOR_TEST);var e=this.getViewport();this.gl.scissor(e.Left,e.Bottom,e.Width,e.Height)}}]),t}(s.default);t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(123),l=r(s),c=n(0),f=r(c),d=n(1),h=r(d),p=n(16),_=r(p),v=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){this.getAttributeRaw("bgColor").boundTo("_bgColor"),this.getAttributeRaw("clearDepth").boundTo("_clearDepth")}},{key:"$mount",value:function(){this.gl=this.companion.get("gl")}},{key:"$treeInitialized",value:function(){this.node.getComponent(_.default).register(this.onloop.bind(this),1e3),this.getAttribute("complementRenderer")&&0===this.node.getChildrenByNodeName("renderer").length&&this.node.addChildByName("renderer",{}),this._importSortFromHTML()}},{key:"onloop",value:function(e){if(this.enabled){var t=this._bgColor;this.gl.clearColor(t.R,t.G,t.B,t.A),this.gl.clearDepth(this._clearDepth),this.gl.clear(WebGLRenderingContext.COLOR_BUFFER_BIT|WebGLRenderingContext.DEPTH_BUFFER_BIT),this.node.broadcastMessage(1,"renderViewport",{timer:e})}}},{key:"_importSortFromHTML",value:function(){if(!t._sortImportedFromHTML){for(var e=document.getElementsByTagName("script"),n=0;n<e.length;n++){n=n;var r=e.item(n);if("text/sort"===r.getAttribute("type")){var o=r.getAttribute("typeName");if(!o)throw new Error("Every script tag with 'text/sort' type should have typeName attribute to specify the name to be registered as a material.");r.getAttribute("src")?h.default.addSORTMaterialFromURL(o,r.getAttribute("src")):h.default.addSORTMaterial(o,r.innerText)}}t._sortImportedFromHTML=!0}}}]),t}(f.default);t.default=v,v.attributes={bgColor:{default:new l.default(0,0,0,0),converter:"Color4"},clearDepth:{default:1,converter:"Number"},complementRenderer:{default:!0,converter:"Boolean"}},v._sortImportedFromHTML=!1},function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),l=r(s),c=n(96),f=r(c),d=n(24),h=r(d),p=n(43),_=r(p),v=n(13),y=r(v),b=function(t){function n(){return o(this,n),i(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return a(n,t),u(n,[{key:"$mount",value:function(){var t=this,n=this.getAttribute("name");if(!n)throw new Error("Rendering target must have name");0===this.node.children.length&&this._instanciateDefaultBuffers(n),e(function(){var e=t.node.getComponentsInChildren(y.default),r=e[0].texture,o=t.node.getComponentsInChildren(_.default);t.renderingTarget=new f.default(t.companion.get("gl"),[r],o[0].buffer),h.default.get(t.companion.get("gl")).setRenderingTarget(n,t.renderingTarget)})}},{key:"_instanciateDefaultBuffers",value:function(e){this.node.addChildByName("color-buffer",{name:e,format:this.getAttribute("colorBufferFormat"),type:this.getAttribute("colorBufferType"),resizerType:this.getAttribute("resizerType")}),0!==this.getAttribute("depthBufferType")&&this.node.addChildByName("render-buffer",{name:e,type:this.getAttribute("depthBufferType"),resizerType:this.getAttribute("resizerType")})}}]),n}(l.default);t.default=b,b.attributes={name:{converter:"String",default:null},colorBufferFormat:{converter:"Enum",default:WebGLRenderingContext.RGBA,table:{RGBA:WebGLRenderingContext.RGBA,RGB:WebGLRenderingContext.RGB,ALPHA:WebGLRenderingContext.ALPHA,LUMINANCE:WebGLRenderingContext.LUMINANCE,LUMINANCE_ALPHA:WebGLRenderingContext.LUMINANCE_ALPHA,SRGB_EXT:WebGLRenderingContext.SRGB_EXT,SRGB_ALPHA_EXT:WebGLRenderingContext.SRGB_ALPHA_EXT,DEPTH_COMPONENT:WebGLRenderingContext.DEPTH_COMPONENT,DEPTH_STENCIL:WebGLRenderingContext.DEPTH_STENCIL}},colorBufferType:{converter:"Enum",default:WebGLRenderingContext.UNSIGNED_BYTE,table:{UNSIGNED_BYTE:WebGLRenderingContext.UNSIGNED_BYTE,UNSIGNED_SHORT_5_6_5:WebGLRenderingContext.UNSIGNED_SHORT_5_6_5,UNSIGNED_SHORT_4_4_4_4:WebGLRenderingContext.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:WebGLRenderingContext.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT:WebGLRenderingContext.UNSIGNED_SHORT,UNSIGNED_INT:WebGLRenderingContext.UNSIGNED_INT,FLOAT:WebGLRenderingContext.FLOAT}},depthBufferType:{converter:"Enum",default:WebGLRenderingContext.DEPTH_COMPONENT16,table:{NONE:0,DEPTH_COMPONENT16:WebGLRenderingContext.DEPTH_COMPONENT16}},resizerType:{converter:"String",default:"ViewportSize"}}}).call(t,n(95).setImmediate)},function(e,t,n){function r(e,t){this._id=e,this._clearFn=t}var o=Function.prototype.apply;t.setTimeout=function(){return new r(o.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new r(o.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(124),t.setImmediate=setImmediate,t.clearImmediate=clearImmediate},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(42),u=r(a),s=n(6),l=r(s),c=function(){function e(t,n,r){if(o(this,e),this.gl=t,this.textures=n,this.depthBuffer=r,0===n.length)throw new Error("Textures must contain 1 texture at least");this.fbo=new u.default(t);for(var i=0;i<n.length;i++)this.fbo.update(this.textures[i],0,i);this.fbo.update(r)}return i(e,[{key:"beforeDraw",value:function(e,t,n){if(this.bind(),0!==e){var r=0;0!=(e&WebGLRenderingContext.COLOR_BUFFER_BIT)&&t&&(this.gl.clearColor.apply(this.gl,t),r|=WebGLRenderingContext.COLOR_BUFFER_BIT),0!=(e&WebGLRenderingContext.DEPTH_BUFFER_BIT)&&null!==n&&this.depthBuffer&&(this.gl.clearDepth(n),r|=WebGLRenderingContext.DEPTH_BUFFER_BIT),0!==r&&this.gl.clear(r)}this.getViewport().configure(this.gl)}},{key:"getBufferWidth",value:function(){return this.texture.width}},{key:"getBufferHeight",value:function(){return this.texture.height}},{key:"getViewport",value:function(){return new l.default(0,0,this.getBufferWidth(),this.getBufferHeight())}},{key:"bind",value:function(){this.fbo.bind()}},{key:"texture",get:function(){return this.textures[0]}}]),e}();t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),l=r(s),c=n(42),f=r(c),d=n(25),h=r(d),p=n(2),_=r(p),v=n(6),y=r(v),b=n(46),m=r(b),g=n(12),w=r(g),E=n(47),R=r(E),O=n(29),T=r(O),C=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._readCache=new Uint8Array(4),e}return a(t,e),u(t,[{key:"$mount",value:function(){if(this._sceneRenderer=this.node.getComponent(R.default),!this._sceneRenderer)throw new Error("The node attaching RenderHitArea should contain RenderScene.");this._gl=this.companion.get("gl"),this._canvas=this.companion.get("canvasElement"),this.hitareaTexture=new _.default(this._gl),this.hitareaRenderbuffer=new h.default(this._gl),this.hitareaFBO&&(this.hitareaFBO.destroy(),this.hitareaFBO=null)}},{key:"$resizeViewport",value:function(e){var t=w.default.getPow2Size(e.width,e.height);this._bufferViewport=new y.default(0,0,t.width,t.height),this.hitareaTexture.update(0,t.width,t.height,0,WebGLRenderingContext.RGBA,WebGLRenderingContext.UNSIGNED_BYTE),this.hitareaRenderbuffer.update(WebGLRenderingContext.DEPTH_COMPONENT16,t.width,t.height),this.hitareaFBO||(this.hitareaFBO=new f.default(this._gl),this.hitareaFBO.update(this.hitareaTexture),this.hitareaFBO.update(this.hitareaRenderbuffer))}},{key:"$render",value:function(e){if(this._mouseInside){var t=this._sceneRenderer.camera||e.camera;t&&(this.hitareaFBO.bind(),this._bufferViewport.configure(this._gl),this._gl.clearColor(0,0,0,0),this._gl.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this._gl.clearDepth(1),this._gl.clear(WebGLRenderingContext.DEPTH_BUFFER_BIT),t.renderScene({renderer:this._sceneRenderer,camera:t,layer:this._sceneRenderer.layer,viewport:e.viewport,timer:e.timer,technique:"hitarea",sceneDescription:{},sortingTechnique:"default",rendererDescription:this.rendererDescription}),this._gl.flush(),this._gl.readPixels(this._lastPosition[0]*this._bufferViewport.Width,this._lastPosition[1]*this._bufferViewport.Height,1,1,WebGLRenderingContext.RGBA,WebGLRenderingContext.UNSIGNED_BYTE,this._readCache),this._updateCurrentIndex(m.default.fromColor(this._readCache),t),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null))}}},{key:"$mousemove",value:function(e){this._lastPosition=[e.viewportNormalizedX,e.viewportNormalizedY],this._mouseMoved=!0}},{key:"$mouseenter",value:function(e){this._mouseInside=!0,this._lastPosition=[e.viewportNormalizedX,e.viewportNormalizedY],this._mouseMoved=!0}},{key:"$mouseleave",value:function(e){this._mouseInside=!1,this._lastPosition=[e.viewportNormalizedX,e.viewportNormalizedY],this._mouseMoved=!0,this._lastRenderable instanceof l.default&&this._lastRenderable.node.emit("mouseleave",this._lastRenderable),this._lastRenderable=null}},{key:"_updateCurrentIndex",value:function(e,t){if(0===e)this._lastRenderable instanceof l.default&&this._lastRenderable.node.emit("mouseleave",this._lastRenderable),this._lastRenderable=null;else{var n=t.containedScene.queueRegistory.getByIndex(e-1);this._lastRenderable!==n?(this._lastRenderable instanceof l.default&&this._lastRenderable.node.emit("mouseleave",this._lastRenderable),n instanceof l.default&&n.node.emit("mouseenter",n)):n instanceof l.default&&(this._mouseMoved?n.node.emit("mousemove",n):n.node.emit("mouseon",n)),this._lastRenderable=n}}}]),t}(T.default);t.default=C,C.attributes={}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(5),l=r(s),c=n(0),f=r(c),d=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.rendererDescription={mouse:{coords:{canvas:[0,0],canvasNormalized:[0,0],viewport:[0,0],viewportNormalized:[0,0]},left:!1,right:!1,inside:!1}},e.metadata={},e}return a(t,e),u(t,[{key:"$mousemove",value:function(e){this._assignMouseState(e)}},{key:"$mouseenter",value:function(e){this._assignMouseState(e)}},{key:"$mouseleave",value:function(e){this._assignMouseState(e)}},{key:"$mousedown",value:function(e){this._assignMouseState(e)}},{key:"$mouseup",value:function(e){this._assignMouseState(e)}},{key:"__beforeRender",value:function(){if(l.default.debug&&window.spector){var e="";for(var t in this.metadata)void 0!==this.metadata[t]&&(e+=t+"="+this.metadata[t]+"|");window.spector.setMarker("Renderer|"+e)}return!0}},{key:"_assignMouseState",value:function(e){var t=this.rendererDescription.mouse;t.inside=e.inside,t.coords.viewport=[e.viewportX,e.viewportY],t.coords.viewportNormalized=[e.viewportNormalizedX,e.viewportNormalizedY],t.coords.canvas=[e.canvasX,e.canvasY],t.coords.canvasNormalized=[e.canvasNormalizedX,e.canvasNormalizedY],t.left=this._isLeftButtonPressed(e),t.right=this._isRightButtonPressed(e)}},{key:"_isLeftButtonPressed",value:function(e){return 1===e.buttons||void 0===e.buttons&&1===e.which}},{key:"_isRightButtonPressed",value:function(e){return 2===e.buttons||void 0===e.buttons&&3===e.which}}]),t}(f.default);t.default=d,d.attributes={}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(22),c=r(l),f=n(29),d=r(f),h=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},p=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){var e=this;s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"$awake",this).call(this),this.metadata.type="Quad",this.getAttributeRaw("indexGroup").boundTo("indexGroup"),this.getAttributeRaw("technique").boundTo("technique"),this.getAttributeRaw("technique").watch(function(t){e.metadata.technique=t},!0)}},{key:"$mount",value:function(){return h(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._gl=this.companion.get("gl"),this._materialContainer=this.node.getComponent(c.default),t=this.companion.get("GeometryRegistory"),e.next=5,t.getGeometry("quad");case 5:this._geom=e.sent;case 6:case"end":return e.stop()}},e,this)}))}},{key:"$render",value:function(e){if(this._materialContainer.materialReady&&this._geom&&this.__beforeRender()){var t={indexGroup:this.indexGroup,geometry:this._geom,camera:null,transform:null,viewport:this.out.getViewport(),technique:this.technique,sceneDescription:{},rendererDescription:this.rendererDescription};this._materialContainer.material.draw(t),this._gl.flush()}}}]),t}(d.default);t.default=p,p.attributes={indexGroup:{default:"default",converter:"String"},technique:{default:"default",converter:"String"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(26),c=r(l),f=n(30),d=r(f),h=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"$awake",this).call(this);var e=this.getAttribute("name"),n=this.getAttribute("format"),r=this.getAttribute("type");e&&c.default.get(this.companion.get("gl")).setBackbuffer(this.getAttribute("name"),this.__texture),this.__texture.update(0,1,1,0,n,r,null)}},{key:"resize",value:function(e,t){var n=this.getAttribute("format"),r=this.getAttribute("type");this.__texture.update(0,e,t,0,n,r,null)}}]),t}(d.default);t.default=h,h.attributes={name:{converter:"String",default:null},format:{converter:"Enum",default:WebGLRenderingContext.RGBA,table:{RGBA:WebGLRenderingContext.RGBA,RGB:WebGLRenderingContext.RGB,ALPHA:WebGLRenderingContext.ALPHA,LUMINANCE:WebGLRenderingContext.LUMINANCE,LUMINANCE_ALPHA:WebGLRenderingContext.LUMINANCE_ALPHA,SRGB_EXT:WebGLRenderingContext.SRGB_EXT,SRGB_ALPHA_EXT:WebGLRenderingContext.SRGB_ALPHA_EXT,DEPTH_COMPONENT:WebGLRenderingContext.DEPTH_COMPONENT,DEPTH_STENCIL:WebGLRenderingContext.DEPTH_STENCIL}},type:{converter:"Enum",default:WebGLRenderingContext.UNSIGNED_BYTE,table:{UNSIGNED_BYTE:WebGLRenderingContext.UNSIGNED_BYTE,UNSIGNED_SHORT_5_6_5:WebGLRenderingContext.UNSIGNED_SHORT_5_6_5,UNSIGNED_SHORT_4_4_4_4:WebGLRenderingContext.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:WebGLRenderingContext.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT:WebGLRenderingContext.UNSIGNED_SHORT,UNSIGNED_INT:WebGLRenderingContext.UNSIGNED_INT,FLOAT:WebGLRenderingContext.FLOAT}}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(33),c=r(l),f=n(30),d=r(f),h=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},p=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){var e=this;s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"$awake",this).call(this),this.__bindAttributes(),this.getAttributeRaw("src").watch(function(t){null!==t&&e._loadTask(t)},!0)}},{key:"resize",value:function(e,t){this._resolvedImage&&(this._resolvedImage.width=e,this._resolvedImage.height=t,this._updateTexture())}},{key:"_loadTask",value:function(e){return h(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.default.resolve(e);case 2:n=t.sent,this._resolvedImage=n,this._updateTexture();case 5:case"end":return t.stop()}},t,this)}))}},{key:"_updateTexture",value:function(){this.__texture.update(this._resolvedImage,{premultipliedAlpha:this.premultipliedAlpha,flipY:this.flipY})}}]),t}(d.default);t.default=p,p.attributes={src:{converter:"String",default:null}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(50),c=r(l),f=n(30),d=r(f),h=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},p=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){var e=this;s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"$awake",this).call(this),this.__bindAttributes(),this.getAttributeRaw("src").watch(function(t){null!==t&&e._loadTask(t)},!0),this.getAttributeRaw("currentTime").watch(function(t){e.video&&e.video.currentTime!==e.currentTime&&e._syncVideoPref()}),this.getAttributeRaw("muted").watch(function(){e.video&&e._syncVideoPref()}),this.getAttributeRaw("playbackRate").watch(function(){e.video&&e._syncVideoPref()}),this.getAttributeRaw("loop").watch(function(){e.video&&e._syncVideoPref()})}},{key:"resize",value:function(e,t){this.video&&(this.video.width=e,this.video.height=t,this.tryUpdateCurrentFrame())}},{key:"_update",value:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentTime!==this.video.currentTime&&(this.currentTime=this.video.currentTime),this.tryUpdateCurrentFrame(),e.next=5,1;case 5:e.next=0;break;case 7:case"end":return e.stop()}},e,this)})},{key:"tryUpdateCurrentFrame",value:function(){this.video.readyState===this.video.HAVE_ENOUGH_DATA&&this.__texture.update(this.video,{premultipliedAlpha:this.premultipliedAlpha,flipY:this.flipY})}},{key:"_loadTask",value:function(e){return h(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.default.resolve(e);case 2:this.video=t.sent,this.__registerFrameCoroutine(this._update),this.video.play(),this._syncVideoPref(),this._update();case 7:case"end":return t.stop()}},t,this)}))}},{key:"_syncVideoPref",value:function(){this.video.playbackRate=this.playbackRate,this.video.muted=this.muted,this.video.loop=this.loop,this.video.currentTime=this.currentTime}}]),t}(d.default);t.default=p,p.attributes={src:{converter:"String",default:null},currentTime:{converter:"Number",default:0},muted:{converter:"Boolean",default:!0},playbackRate:{converter:"Number",default:1},loop:{converter:"Boolean",default:!0}}},function(e,t,n){"use strict";function r(e){if("fit"===e)return{mode:"fit"};if("string"==typeof e){var t=/aspect\(([\d+(?.\d*)?]+)\)/.exec(e);if(t)return{mode:"aspect",aspect:Number.parseFloat(t[1])}}return{mode:"manual",size:Number.parseFloat(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,n){"use strict";function r(e,t){if("string"==typeof e){return t.companion.get("GeometryRegistory").getGeometry(e)}if(e instanceof i.default)return Promise.resolve(e);throw new Error('Specified geometry "'+e+'" is not supported for converting into geometry.')}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var o=n(10),i=function(e){return e&&e.__esModule?e:{default:e}}(o)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if("string"==typeof e){var n=/\s*new\s*\(\s*([a-zA-Z\d\-]+)\s*\)/,r=void 0;if(r=n.exec(e))return t.component[t.declaration.componentBoundTo]=null,c.default.get(t.companion.get("gl")).instanciate(r[1]);var o=t.tree(e).first();if(o){var i=o.getComponent(a.default);return t.component[t.declaration.componentBoundTo]=i,i.materialPromise}return console.warn("There was no matching material component filtered by '"+e+"'"),null}return e instanceof s.default?(t.component[t.declaration.componentBoundTo]=null,Promise.resolve(e)):null}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=n(39),a=r(i),u=n(37),s=r(u),l=n(1),c=r(l)},function(e,t,n){"use strict";function r(e,t){return null===e?null:e instanceof i.default?e:"string"==typeof e?t.component.node.tree(e).first():void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var o=n(127),i=function(e){return e&&e.__esModule?e:{default:e}}(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(128),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default={name:"Position",lazy:!0,verify:function(e){return!0},convert:function(e,t){if(null===e)return null;if(t.convertContext._lastVal===e)return t.convertContext._node.getAttribute("position");t.convertContext._lastVal=null;try{var n=o.default.convert("Vector3",t,e);if(n)return n}catch(e){}return t.convertContext._node=o.default.convert("Node",t,e),t.convertContext._node?(t.convertContext._lastVal=e,t.convertContext._node.getAttribute("position")):void 0}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e;return"object"===(void 0===e?"undefined":a(e))&&"function"==typeof t.beforeDraw&&"function"==typeof t.getBufferHeight&&"function"==typeof t.getBufferWidth&&"function"==typeof t.getViewport}function i(e,t){return f(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!o(e)){n.next=4;break}return n.abrupt("return",e);case 4:if("string"!=typeof e){n.next=14;break}if("default"!==e){n.next=10;break}return r=t.component.node.getComponentInAncestor(s.default),n.abrupt("return",r.renderingTarget);case 10:if(!(i=c.default.get(t.companion.get("gl")).getRenderingTarget(e))){n.next=13;break}return n.abrupt("return",i);case 13:throw new Error('Specified rendering target "'+e+'" was not found.');case 14:return n.abrupt("return",null);case 15:case"end":return n.stop()}},n,this)}))}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=i;var u=n(23),s=r(u),l=n(24),c=r(l),f=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=/(query|backbuffer)\((.+)\)[^\)]*$/,n=void 0;return(n=t.exec(e))?{type:n[1],param:n[2]}:null}function i(e,t){if(e instanceof v.default)return new d.default(e);if(e instanceof d.default)return e;if("string"==typeof e){var n=o(e);if(!n){var r=new v.default(t.companion.get("gl"));return s.default.resolve(e).then(function(e){r.update(e)}),t.companion.get("loader").register(r.validPromise),new d.default(r)}var i=n.param;switch(n.type){case"backbuffer":return new d.default(function(e){return p.default.get(t.companion.get("gl")).getBackbuffer(i)});case"query":var u=t.tree(i),l=u.first().getComponent(c.default);return new d.default(function(){return l.texture})}}if("object"===(void 0===e?"undefined":a(e))){if(e instanceof HTMLImageElement){var f=new v.default(t.companion.get("gl"));return e.complete&&e.naturalWidth?f.update(e):e.onload=function(){f.update(e)},new d.default(f)}if(e instanceof HTMLCanvasElement){var h=new v.default(t.companion.get("gl"));return h.update(e),new d.default(h)}}return null}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=i;var u=n(33),s=r(u),l=n(13),c=r(l),f=n(110),d=r(f),h=n(26),p=r(h),_=n(2),v=r(_)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){r(this,e),this.rawResource=t,this.isFunctionalProxy="function"==typeof t}return o(e,[{key:"get",value:function(e){return this.isFunctionalProxy?this.rawResource(e):this.rawResource}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=/(\d+)\s*%/,r=void 0;if(r=n.exec(t)){var o=Number.parseFloat(r[1]);return Math.floor(e*o*.01)}return Math.floor(Number.parseFloat(t))}function i(e){if(e instanceof u.default){var t=new l.default(e.Left,e.Bottom,e.Width,e.Height);return function(){return t}}if(e instanceof l.default)return function(){return e};if("string"==typeof e){if("auto"===e)return function(e){return new l.default(0,0,e.width,e.height)};var n=e.split(",");if(4!==n.length)throw new Error("Invalid viewport size was specified.");return function(e){return new l.default(o(e.width,n[0]),o(e.height,n[1]),o(e.width,n[2]),o(e.height,n[3]))}}throw new Error(e+" could not be parsed")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var a=n(84),u=r(a),s=n(6),l=r(s)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(69),u=r(a),s=n(7),l=r(s),c=n(10),f=r(c),d=n(21),h=r(d),p=n(113),_=r(p),v=new u.default;v.expand(new l.default(-1,-1,-1)),v.expand(new l.default(1,1,1));var y={POSITION:{size:3,stride:32},NORMAL:{size:3,stride:32,offset:12},TEXCOORD:{size:2,stride:32,offset:24}},b=function(){function e(){o(this,e)}return i(e,null,[{key:"register",value:function(){e._registerQuad(),e._registerCube(),e._registerSphere(),e._registerCircle(),e._registerCylinder(),e._registerCone(),e._registerPlane(),e._registerTriangle(),e._registerCapsule()}},{key:"_registerQuad",value:function(){h.default.addType("quad",{},function(e,t){var n=new f.default(e);return n.addAttributes(_.default.plane([0,0,0],[0,0,1],[0,1,0],[1,0,0],1,1),y),n.addIndex("default",_.default.planeIndex(0,1,1)),n.addIndex("wireframe",_.default.linesFromTriangles(_.default.planeIndex(0,1,1)),WebGLRenderingContext.LINES),n})}},{key:"_registerTriangle",value:function(){h.default.addType("triangle",{},function(e,t){var n=new f.default(e);return n.addAttributes(_.default.triangle([0,0,0],[0,0,1],[0,1,0],[1,0,0]),y),n.addIndex("default",_.default.triangleIndex(0)),n.addIndex("wireframe",_.default.linesFromTriangles(_.default.triangleIndex(0)),WebGLRenderingContext.LINES),n})}},{key:"_registerCone",value:function(){h.default.addType("cone",{divide:{converter:"Number",default:50}},function(e,t){for(var n=t.divide,r=new f.default(e),o=n%2!=0?Math.PI/n:0,i=[].concat.apply([],[_.default.circle([0,-.5,0],[0,-1,0],[-Math.sin(o),0,Math.cos(o)],[Math.cos(o),0,Math.sin(o)],n)]),a=Math.cos(Math.PI/n)/3,u=Math.sin(Math.PI/n)/Math.pow(3,.5)*2,s=Math.cos(Math.PI/n)-a,l=Math.PI/n,c=0;c<n;c++){var d=l*(2*c+1);Array.prototype.push.apply(i,_.default.coneTriangle([-Math.sin(d)*s,0,-Math.cos(d)*s],[-Math.cos(Math.PI/2-d),1,-Math.sin(Math.PI/2-d)],[Math.sin(d)*s,1,Math.cos(d)*s],[-Math.cos(d)*u,0,Math.sin(d)*u],n,c))}r.addAttributes(i,y);for(var h=n+2,p=[].concat.apply([],[_.default.circleIndex(0,n)]),v=0;v<n;v++)Array.prototype.push.apply(p,_.default.triangleIndex(h+3*v));return r.addIndex("default",p),r.addIndex("wireframe",_.default.linesFromTriangles(p),WebGLRenderingContext.LINES),r})}},{key:"_registerCylinder",value:function(){h.default.addType("cylinder",{divide:{converter:"Number",default:50}},function(e,t){for(var n=t.divide,r=new f.default(e),o=n%2!=0?Math.PI/n:0,i=[].concat.apply([],[_.default.circle([0,1,0],[0,1,0],[0,0,-1],[1,0,0],n),_.default.circle([0,-1,0],[0,-1,0],[-Math.sin(o),0,Math.cos(o)],[Math.cos(o),0,Math.sin(o)],n)]),a=Math.sin(Math.PI/n),u=Math.cos(Math.PI/n),s=Math.PI/n,l=0;l<n;l++){var c=s*(2*l+1);Array.prototype.push.apply(i,_.default.cylinderPlane([-Math.sin(c)*u,0,-Math.cos(c)*u],[-Math.sin(c),0,-Math.cos(c)],[0,1,0],[-Math.cos(c)*a,0,Math.sin(c)*a],n,l))}r.addAttributes(i,y);for(var d=n+2,h=[].concat.apply([],[_.default.circleIndex(0,n),_.default.circleIndex(d,n)]),p=0;p<n;p++)Array.prototype.push.apply(h,_.default.planeIndex(2*d+4*p,1,1));return r.addIndex("default",h),r.addIndex("wireframe",_.default.linesFromTriangles(h),WebGLRenderingContext.LINES),r})}},{key:"_registerCube",value:function(){h.default.addType("cube",{divHorizontal:{converter:"Number",default:1},divVertical:{converter:"Number",default:1}},function(e,t){var n=t.divHorizontal,r=t.divVertical,o=new f.default(e),i=[].concat.apply([],[_.default.plane([0,0,1],[0,0,1],[0,1,0],[1,0,0],n,r),_.default.plane([0,0,-1],[0,0,-1],[0,1,0],[-1,0,0],n,r),_.default.plane([0,1,0],[0,1,0],[0,0,-1],[1,0,0],n,r),_.default.plane([0,-1,0],[0,-1,0],[0,0,-1],[-1,0,0],n,r),_.default.plane([1,0,0],[1,0,0],[0,1,0],[0,0,-1],n,r),_.default.plane([-1,0,0],[-1,0,0],[0,1,0],[0,0,1],n,r)]);o.addAttributes(i,y);var a=(n+1)*(r+1),u=[].concat.apply([],[_.default.planeIndex(0,n,r),_.default.planeIndex(a,n,r),_.default.planeIndex(2*a,n,r),_.default.planeIndex(3*a,n,r),_.default.planeIndex(4*a,n,r),_.default.planeIndex(5*a,n,r)]);return o.addIndex("default",u),o.addIndex("wireframe",_.default.linesFromTriangles(u),WebGLRenderingContext.LINES),o})}},{key:"_registerSphere",value:function(){h.default.addType("sphere",{divVertical:{converter:"Number",default:50},divHorizontal:{converter:"Number",default:50}},function(e,t){var n=t.divHorizontal,r=t.divVertical,o=new f.default(e);return o.addAttributes(_.default.sphere([0,0,0],[0,1,0],[1,0,0],[0,0,1],r,n),y),o.addIndex("default",_.default.sphereIndex(0,r,n)),o.addIndex("wireframe",_.default.linesFromTriangles(_.default.sphereIndex(0,r,n)),WebGLRenderingContext.LINES),o})}},{key:"_registerCapsule",value:function(){h.default.addType("capsule",{divide:{converter:"Number",default:50}},function(e,t){var n=t.divide,r=n%2==1?n+1:n,o=new f.default(e);return o.addAttributes(_.default.capsule([0,0,0],[0,1,0],[1,0,0],[0,0,1],r,n),y),o.addIndex("default",_.default.sphereIndex(0,r,n)),o.addIndex("wireframe",_.default.linesFromTriangles(_.default.sphereIndex(0,r,n)),WebGLRenderingContext.LINES),o})}},{key:"_registerCircle",value:function(){h.default.addType("circle",{divide:{converter:"Number",default:30}},function(e,t){var n=t.divide,r=new f.default(e);return r.addAttributes(_.default.circle([0,0,0],[0,0,1],[0,1,0],[1,0,0],n),y),r.addIndex("default",_.default.circleIndex(0,n)),r.addIndex("wireframe",_.default.linesFromTriangles(_.default.circleIndex(0,n)),WebGLRenderingContext.LINES),r})}},{key:"_registerPlane",value:function(){h.default.addType("plane",{divide:{converter:"Number",default:10}},function(e,t){var n=t.divide,r=n,o=new f.default(e),i=[].concat.apply([],[_.default.plane([0,0,0],[0,0,1],[0,1,0],[1,0,0],n,r),_.default.plane([0,0,0],[0,0,-1],[0,1,0],[-1,0,0],n,r,!0)]);o.addAttributes(i,y);var a=[].concat.apply([],[_.default.planeIndex(0,n,r),_.default.planeIndex((n+1)*(r+1),n,r)]);return o.addIndex("default",a),o.addIndex("wireframe",_.default.linesFromTriangles(a),WebGLRenderingContext.LINES),o})}}]),e}();t.default=b},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){r(this,e)}return o(e,null,[{key:"linesFromTriangles",value:function(e){var t=[],n=new Array(3),r=0,o=!0,i=!1,a=void 0;try{for(var u,s=e[Symbol.iterator]();!(o=(u=s.next()).done);o=!0){var l=u.value;if(n[r%3]=l,r%3==2){var c=n[0],f=n[1],d=n[2];Array.prototype.push.apply(t,[c,f,f,d,d,c])}r++}}catch(e){i=!0,a=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}return t}},{key:"plane",value:function(e,t,n,r){for(var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=new Array(8*(o+1)*(i+1)),s=[e[0]-n[0]-r[0],e[1]-n[1]-r[1],e[2]-n[2]-r[2]],l=[r[0]/o*2,r[1]/o*2,r[2]/o*2],c=[n[0]/i*2,n[1]/i*2,n[2]/i*2],f=0;f<i+1;f++)for(var d=0;d<o+1;d++){var h=8*((o+1)*f+d);u[h+0]=s[0]+l[0]*d+c[0]*f,u[h+1]=s[1]+l[1]*d+c[1]*f,u[h+2]=s[2]+l[2]*d+c[2]*f,u[h+3]=t[0],u[h+4]=t[1],u[h+5]=t[2],u[h+6]=a?1-1/o*d:1/o*d,u[h+7]=1/i*f}return u}},{key:"cylinderPlane",value:function(e,t,n,r,o,i){for(var a=new Array(32),u=[e[0]-n[0]-r[0],e[1]-n[1]-r[1],e[2]-n[2]-r[2]],s=[2*r[0],2*r[1],2*r[2]],l=[2*n[0],2*n[1],2*n[2]],c=0;c<2;c++)for(var f=0;f<2;f++){var d=8*(2*c+f);a[d+0]=u[0]+s[0]*f+l[0]*c,a[d+1]=u[1]+s[1]*f+l[1]*c,a[d+2]=u[2]+s[2]*f+l[2]*c;var h=Math.tan(Math.PI/o)/Math.sin(Math.PI/o);0===f?(a[d+3]=t[0]-h*r[0],a[d+4]=t[1]-h*r[1],a[d+5]=t[2]-h*r[2]):(a[d+3]=t[0]+h*r[0],a[d+4]=t[1]+h*r[1],a[d+5]=t[2]+h*r[2]),a[d+6]=1/o*(i+1+f),a[d+7]=0===c?0:1}return a}},{key:"triangle",value:function(e,t,n,r){for(var o=new Array(24),i=2*Math.PI/3,a=0;a<3;a++){var u=Math.sin(i*a),s=Math.cos(i*a);o[0+8*a]=e[0]+s*n[0]+u*r[0],o[1+8*a]=e[1]+s*n[1]+u*r[1],o[2+8*a]=e[2]+s*n[2]+u*r[2],o[3+8*a]=t[0],o[4+8*a]=t[1],o[5+8*a]=t[2],o[6+8*a]=.5+(s*n[0]+u*r[0])/2,o[7+8*a]=.5+(s*n[1]+u*r[1])/2}return o}},{key:"coneTriangle",value:function(e,t,n,r,o,i){for(var a=new Array(24),u=2*Math.PI/3,s=0;s<3;s++){var l=Math.sin(u*s),c=Math.cos(u*s);a[0+8*s]=e[0]+c*n[0]+l*r[0],a[1+8*s]=e[1]+c*n[1]+l*r[1],a[2+8*s]=e[2]+c*n[2]+l*r[2],a[3+8*s]=t[0],a[4+8*s]=t[1],a[5+8*s]=t[2];var f=Math.pow(2,.5),d=Math.tan(Math.PI/o)/Math.sin(Math.PI/o)/Math.pow(3,.5)*2;0===s?(a[3+8*s]=t[0],a[4+8*s]=t[1],a[5+8*s]=t[2],a[6+8*s]=0,a[7+8*s]=0):1===s?(a[3+8*s]=t[0]/f+d*r[0],a[4+8*s]=t[1]/f+d*r[1],a[5+8*s]=t[2]/f+d*r[2],a[6+8*s]=Math.cos(-Math.PI/o/2*(i+1)),a[7+8*s]=Math.sin(-Math.PI/o/2*(i+1))):(a[3+8*s]=t[0]/f-d*r[0],a[4+8*s]=t[1]/f-d*r[1],a[5+8*s]=t[2]/f-d*r[2],a[6+8*s]=Math.cos(-Math.PI/o/2*i),a[7+8*s]=Math.sin(-Math.PI/o/2*i))}return a}},{key:"triangleIndex",value:function(e){var t=new Array(3);return t[0]=e,t[1]=e+2,t[2]=e+1,t}},{key:"planeIndex",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=new Array(6*t*n),o=0;o<n;o++)for(var i=0;i<t;i++){var a=6*(t*o+i),u=e+(t+1)*o+i,s=e+(t+1)*(o+1)+i;r[a+0]=u,r[a+1]=u+1,r[a+2]=s,r[a+3]=s,r[a+4]=u+1,r[a+5]=s+1}return r}},{key:"circle",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,i=new Array(6*(3+o));i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=t[0],i[4]=t[1],i[5]=t[2],i[6]=.5,i[7]=.5;for(var a=2*Math.PI/o,u=0;u<o+1;u++){var s=8+8*u,l=Math.sin(a*u),c=Math.cos(a*u);i[s+0]=e[0]+c*n[0]+l*r[0],i[s+1]=e[1]+c*n[1]+l*r[1],i[s+2]=e[2]+c*n[2]+l*r[2],i[s+3]=t[0],i[s+4]=t[1],i[s+5]=t[2],i[s+6]=.5+.5*l,i[s+7]=.5+.5*c}return i}},{key:"circleIndex",value:function(e,t){for(var n=new Array(3*t),r=0;r<t;r++)n[3*r+0]=e,n[3*r+1]=e+(r+2),n[3*r+2]=e+(r+1);return n}},{key:"capsule",value:function(e,t,n,r){for(var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3,a=new Array(o*i*8),u=0;u<o;u++)for(var s=0;s<i;s++){a[8*(o*u+s)+0]=e[0]+.5*Math.sin(Math.PI*u/(o-1))*(n[0]*Math.cos(2*Math.PI*(s/(i-1)))+r[0]*Math.sin(2*Math.PI*(s/(i-1))))-.5*t[0]*Math.cos(Math.PI*u/(o-1)),a[8*(o*u+s)+1]=e[1]+.5*Math.sin(Math.PI*u/(o-1))*(n[1]*Math.cos(2*Math.PI*(s/(i-1)))+r[1]*Math.sin(2*Math.PI*(s/(i-1))))-.5*t[1]*Math.cos(Math.PI*u/(o-1)),a[8*(o*u+s)+2]=e[2]+.5*Math.sin(Math.PI*u/(o-1))*(n[2]*Math.cos(2*Math.PI*(s/(i-1)))+r[2]*Math.sin(2*Math.PI*(s/(i-1))))-.5*t[2]*Math.cos(Math.PI*u/(o-1));var l=Math.pow(a[8*(o*u+s)+0]*a[8*(o*u+s)+0]+a[8*(o*u+s)+1]*a[8*(o*u+s)+1]+a[8*(o*u+s)+2]*a[8*(o*u+s)+2],.5);a[8*(o*u+s)+3]=a[8*(o*u+s)+0]/l,a[8*(o*u+s)+4]=a[8*(o*u+s)+1]/l,a[8*(o*u+s)+5]=a[8*(o*u+s)+2]/l,a[8*(o*u+s)+6]=1-s/(i-1),a[8*(o*u+s)+7]=u/(o-1)}return a}},{key:"sphere",value:function(e,t,n,r,o,i){for(var a=new Array(o*i*8),u=0;u<o;u++)for(var s=0;s<i;s++){a[8*(o*u+s)+0]=e[0]+Math.sin(Math.PI*u/(o-1))*(n[0]*Math.cos(2*Math.PI*(s/(i-1)))+r[0]*Math.sin(2*Math.PI*(s/(i-1))))-t[0]*Math.cos(Math.PI*u/(o-1)),a[8*(o*u+s)+1]=e[1]+Math.sin(Math.PI*u/(o-1))*(n[1]*Math.cos(2*Math.PI*(s/(i-1)))+r[1]*Math.sin(2*Math.PI*(s/(i-1))))-t[1]*Math.cos(Math.PI*u/(o-1)),a[8*(o*u+s)+2]=e[2]+Math.sin(Math.PI*u/(o-1))*(n[2]*Math.cos(2*Math.PI*(s/(i-1)))+r[2]*Math.sin(2*Math.PI*(s/(i-1))))-t[2]*Math.cos(Math.PI*u/(o-1));var l=Math.pow(a[8*(o*u+s)+0]*a[8*(o*u+s)+0]+a[8*(o*u+s)+1]*a[8*(o*u+s)+1]+a[8*(o*u+s)+2]*a[8*(o*u+s)+2],.5);a[8*(o*u+s)+3]=a[8*(o*u+s)+0]/l,a[8*(o*u+s)+4]=a[8*(o*u+s)+1]/l,a[8*(o*u+s)+5]=a[8*(o*u+s)+2]/l,a[8*(o*u+s)+6]=1-s/(i-1),a[8*(o*u+s)+7]=u/(o-1)}return a}},{key:"sphereIndex",value:function(e,t,n){for(var r=new Array(n*t*6),o=0;o<t-1;o++)for(var i=0;i<n-1;i++)r[6*(t*i+o)+0]=t*o+i,r[6*(t*i+o)+1]=t*(o+1)+i,r[6*(t*i+o)+2]=t*o+i+1,r[6*(t*i+o)+3]=t*o+i+1,r[6*(t*i+o)+4]=t*(o+1)+i,r[6*(t*i+o)+5]=t*(o+1)+i+1;return r}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(130),u=r(a),s=n(1),l=r(s),c=function(){function e(){o(this,e)}return i(e,null,[{key:"register",value:function(){l.default.addSORTMaterial("unlit",u.default)}}]),e}();t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.__NAME__=t.__VERSION__=void 0;var o=n(48),i=r(o),a=n(31),u=r(a),s=n(32),l=r(s),c=n(33),f=r(c),d=n(14),h=r(d),p=n(49),_=r(p),v=n(50),y=r(v),b=n(34),m=r(b),g=n(15),w=r(g),E=n(52),R=r(E),O=n(55),T=r(O),C=n(85),x=r(C),P=n(86),M=r(P),S=n(87),k=r(S),A=n(16),j=r(A),L=n(39),I=r(L),N=n(40),G=r(N),F=n(22),D=r(F),B=n(89),W=r(B),U=n(90),V=r(U),H=n(91),z=r(H),q=n(122),X=r(q),$=n(23),Y=r($),J=n(93),Z=r(J),Q=n(94),K=r(Q),ee=n(97),te=r(ee),ne=n(99),re=r(ne),oe=n(47),ie=r(oe),ae=n(98),ue=r(ae),se=n(29),le=r(se),ce=n(19),fe=r(ce),de=n(100),he=r(de),pe=n(44),_e=r(pe),ve=n(101),ye=r(ve),be=n(43),me=r(be),ge=n(27),we=r(ge),Ee=n(28),Re=r(Ee),Oe=n(13),Te=r(Oe),Ce=n(30),xe=r(Ce),Pe=n(102),Me=r(Pe),Se=n(45),ke=r(Se),Ae=n(8),je=r(Ae),Le=n(103),Ie=r(Le),Ne=n(104),Ge=r(Ne),Fe=n(105),De=r(Fe),Be=n(106),We=r(Be),Ue=n(107),Ve=r(Ue),He=n(108),ze=r(He),qe=n(109),Xe=r(qe),$e=n(111),Ye=r($e),Je=n(112),Ze=r(Je),Qe=n(10),Ke=r(Qe),et=n(21),tt=r(et),nt=n(113),rt=r(nt),ot=n(129),it=r(ot),at=n(72),ut=r(at),st=n(66),lt=r(st),ct=n(114),ft=r(ct),dt=n(61),ht=r(dt),pt=n(71),_t=r(pt),vt=n(65),yt=r(vt),bt=n(37),mt=r(bt),gt=n(1),wt=r(gt),Et=n(68),Rt=r(Et),Ot=n(73),Tt=r(Ot),Ct=n(80),xt=r(Ct),Pt=n(67),Mt=r(Pt),St=n(110),kt=r(St),At=n(82),jt=r(At),Lt=n(11),It=r(Lt),Nt=n(131),Gt=r(Nt),Ft=n(132),Dt=r(Ft),Bt=n(134),Wt=r(Bt),Ut=n(135),Vt=r(Ut),Ht=n(70),zt=r(Ht),qt=n(42),Xt=r(qt),$t=n(20),Yt=r($t),Jt=n(3),Zt=r(Jt),Qt=n(4),Kt=r(Qt),en=n(81),tn=r(en),nn=n(38),rn=r(nn),on=n(74),an=r(on),un=n(78),sn=r(un),ln=n(75),cn=r(ln),fn=n(25),dn=r(fn),hn=n(92),pn=r(hn),_n=n(41),vn=r(_n),yn=n(96),bn=r(yn),mn=n(26),gn=r(mn),wn=n(24),En=r(wn),Rn=n(76),On=r(Rn),Tn=n(79),Cn=r(Tn),xn=n(83),Pn=r(xn),Mn=n(2),Sn=r(Mn),kn=n(77),An=r(kn),jn=n(6),Ln=r(jn),In=n(88),Nn=r(In),Gn=n(53),Fn=r(Gn),Dn=n(54),Bn=r(Dn),Wn=n(59),Un=r(Wn),Vn=n(60),Hn=r(Vn),zn=n(62),qn=r(zn),Xn=n(57),$n=r(Xn),Yn=n(63),Jn=r(Yn),Zn=n(58),Qn=r(Zn),Kn=n(64),er=r(Kn),tr=n(9),nr=r(tr),rr=n(46),or=r(rr),ir=n(12),ar=r(ir),ur=n(51),sr=r(ur),lr=n(136),cr=r(lr),fr=n(5),dr=r(fr),hr=t.__VERSION__="0.30.0beta5",pr=t.__NAME__="grimoirejs-fundamental",_r={Asset:{AssetLoader:i.default,CacheResolver:u.default,ExternalResourceResolver:l.default,ImageResolver:f.default,NameResolver:h.default,TextFileResolver:_.default,VideoResolver:y.default},Components:{AssetLoadingManagerComponent:m.default,BasicComponent:w.default,CameraComponent:R.default,CanvasInitializerComponent:T.default,FullscreenComponent:x.default,GeometryComponent:M.default,GeometryRegistoryComponent:k.default,LoopManagerComponent:j.default,MaterialComponent:I.default,MaterialContainerBase:G.default,MaterialContainerComponent:D.default,MaterialImporterComponent:W.default,MeshRendererComponent:V.default,MouseCameraControlComponent:z.default,RenderComponentBase:X.default,RendererComponent:Y.default,RendererManagerComponent:Z.default,RenderingTargetComponent:K.default,RenderStage:{RenderHitareaComponent:te.default,RenderQuadComponent:re.default,RenderSceneComponent:ie.default,RenderStageBase:ue.default,SingleBufferRenderStageBase:le.default},SceneComponent:fe.default,Texture:{ColorBufferTextureUpdator:he.default,ConstantSizeResourceResizer:_e.default,ImageTextureUpdator:ye.default,RenderBufferUpdator:me.default,ResizableResourceUpdator:we.default,ResourceResizerComponentBase:Re.default,TextureContainer:Te.default,TextureUpdatorComponentBase:xe.default,VideoTextureUpdator:Me.default,ViewportSizeResourceResizer:ke.default},TransformComponent:je.default},Converters:{CanvasSizeConverter:Ie.default,GeometryConverter:Ge.default,MaterialConverter:De.default,NodeConverter:We.default,PositionConverter:Ve.default,RenderingTargetConverter:ze.default,TextureConverter:Xe.default,ViewportConverter:Ye.default},Geometry:{DefaultPrimitives:Ze.default,Geometry:Ke.default,GeometryFactory:tt.default,GeometryUtility:rt.default,MorphGeometry:it.default},Material:{Defaults:{DefaultDynamicStateResolvers:ut.default,DefaultMacro:lt.default,DefaultMaterial:ft.default,DefaultStaticImport:ht.default},GLStateConfigurator:_t.default,MacroRegistory:yt.default,Material:mt.default,MaterialFactory:wt.default,Pass:Rt.default,PassProgram:Tt.default,ShaderMixer:xt.default,Technique:Mt.default,TextureReference:kt.default,UniformResolverContainer:jt.default,UniformResolverRegistry:It.default,Uniforms:{MatricesRegister:Gt.default,MiscRegister:Dt.default,UserValueRegister:Wt.default}},nodes:Vt.default,Resource:{Buffer:zt.default,FrameBuffer:Xt.default,GLExtRequestor:Yt.default,GLRelatedRegistryBase:Zt.default,GLResource:Kt.default,GLSLPrecisionChecker:tn.default,GLUtility:rn.default,ManagedProgram:an.default,ManagedShader:sn.default,Program:cn.default,RenderBuffer:dn.default,RenderingTarget:{CanvasRegionRenderingTarget:pn.default,CanvasRenderingTarget:vn.default,OffscreenRenderingTarget:bn.default,RenderingBufferResourceRegistry:gn.default,RenderingTargetRegistry:En.default},ResourceCache:On.default,Shader:Cn.default,Texture:Pn.default,Texture2D:Sn.default,UniformProxy:An.default,Viewport:Ln.default},SceneRenderer:{DrawPriorty:Nn.default,RenderQueue:Fn.default,RenderQueueRegistry:Bn.default},Sort:{CommentRemover:Un.default,ImportResolver:Hn.default,NameSemanticsPair:qn.default,Parser:$n.default,Preferences:Jn.default,SortTransformUtility:Qn.default,TypeToConstant:er.default},Util:{HashCalculator:nr.default,MeshIndexCalculator:or.default,TextureSizeCalculator:ar.default,Timer:sr.default}};dr.default.notifyRegisteringPlugin(pr);var vr=(0,cr.default)();Object.assign(_r,{__VERSION__:hr,__NAME__:pr}),Object.assign(vr||{},_r),window.GrimoireJS.lib.fundamental=_r,t.default=vr},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Base.EEObject},function(e,t){e.exports='<div style="width:100%;height:100%;position: relative;">\n    <div style="width: 55px;height: 55px;border-radius: 100%;border: 5px solid #381794;border-right-color: #FC659D;animation: rotate 1s linear infinite;position: absolute;top: 0;left: 0;right: 0;bottom: 0;margin: auto;"></div>\n</div>\n<style type="text/css">\n    @keyframes rotate {\n        from {\n            transform: rotate(0deg);\n        }\n        to {\n            transform: rotate(360deg);\n        }\n    }\n</style>\n'},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Interface.GrimoireInterface},function(e,t){e.exports="/**\n * Simplest way of transforming vertices on vertex shader\n */\n #ifdef ATTRIBUTE_COLOR_ENABLED\n varying vec4 vColor;\n #endif\n\n varying vec2 vTexCoord;\n varying vec3 vPosition;\n #ifdef ATTRIBUTE_NORMAL_ENABLED\n varying vec3 vNormal;\n #endif\n#ifdef VS\n  @POSITION\n  attribute vec3 position;\n\n  #ifdef ATTRIBUTE_TEXCOORD_ENABLED\n  @TEXCOORD\n  attribute vec2 texCoord;\n  #endif\n\n  #ifdef ATTRIBUTE_NORMAL_ENABLED\n  @NORMAL\n  attribute vec3 normal;\n  #endif\n\n  @MODELVIEWPROJECTION\n  uniform mat4 _matPVM;\n\n  @MODEL\n  uniform mat4 _matM;\n\n  #ifdef ATTRIBUTE_COLOR_ENABLED\n  @COLOR\n  attribute vec4 attrColor;\n  #endif\n\n  #ifdef ATTRIBUTE_POINT_SIZE_ENABLED\n  @POINT_SIZE\n  attribute float pointSize;\n  #endif\n\n  @{default:1.0}\n  uniform float pointScale;\n  void main()\n  {\n    gl_Position = _matPVM * vec4(position,1.0);\n    vPosition = (_matM * vec4(position,1.0)).xyz;\n    #ifdef ATTRIBUTE_NORMAL_ENABLED\n    vNormal = (_matM * vec4(normal,0.)).xyz;\n    #endif\n    #ifdef ATTRIBUTE_TEXCOORD_ENABLED\n    vTexCoord = texCoord;\n    #endif\n    #ifndef ATTRIBUTE_TEXCOORD_ENABLED\n    vTexCoord = position.xy/2.0 + vec2(0.5);\n    #endif\n    #ifdef ATTRIBUTE_COLOR_ENABLED\n    vColor = attrColor;\n    #endif\n    float pSize = 1.0;\n    #ifdef ATTRIBUTE_POINT_SIZE_ENABLED\n    pSize *= pointSize;\n    #endif\n    gl_PointSize = pointScale * pSize;\n  }\n#endif\n"},function(e,t){e.exports="varying vec2 vTexCoord;\nvarying vec2 vScreenPos;\nvarying vec2 vScreenPosWithOffset;\nvarying vec2 vScreenPosNormalized;\nvarying vec2 vAspectScale;\n#ifdef VS\n  @POSITION\n  attribute vec3 position;\n  #ifdef ATTRIBUTE_TEXCOORD_ENABLED\n  @TEXCOORD\n  attribute vec2 texCoord;\n  @VIEWPORT\n  uniform vec4 viewportRect;\n  #endif\n  void main(){\n    gl_Position = vec4(position,1);\n    #ifdef ATTRIBUTE_TEXCOORD_ENABLED\n    vTexCoord = texCoord;\n    #endif\n    #ifndef ATTRIBUTE_TEXCOORD_ENABLED\n    vTexCoord = (position.xy + vec2(1.0)) * vec2(0.5);\n    #endif\n    vScreenPosNormalized = (position.xy + vec2(1.0)) * vec2(0.5);\n    vScreenPos = viewportRect.zw * vScreenPosNormalized;\n    vScreenPosWithOffset = vScreenPos + viewportRect.xy;\n  }\n#endif"},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS&&window.GrimoireJS.lib.math?window.GrimoireJS.lib.math.Quaternion:void 0},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),u=function(e){return e&&e.__esModule?e:{default:e}}(a),s=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),t}(u.default);t.default=s,s.attributes={}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS&&window.GrimoireJS.lib.math?window.GrimoireJS.lib.math.Color4:void 0},function(e,t,n){(function(e,t){!function(e,n){"use strict";function r(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return l[s]=r,u(s),s++}function o(e){delete l[e]}function i(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}function a(e){if(c)setTimeout(a,0,e);else{var t=l[e];if(t){c=!0;try{i(t)}finally{o(e),c=!1}}}}if(!e.setImmediate){var u,s=1,l={},c=!1,f=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?function(){u=function(e){t.nextTick(function(){a(e)})}}():function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&a(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),u=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){a(e.data)},u=function(t){e.port2.postMessage(t)}}():f&&"onreadystatechange"in f.createElement("script")?function(){var e=f.documentElement;u=function(t){var n=f.createElement("script");n.onreadystatechange=function(){a(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():function(){u=function(e){setTimeout(a,0,e)}}(),d.setImmediate=r,d.clearImmediate=o}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,n(125),n(126))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function i(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function a(){_&&h&&(_=!1,h.length?p=h.concat(p):v=-1,p.length&&u())}function u(){if(!_){var e=o(a);_=!0;for(var t=p.length;t;){for(h=p,p=[];++v<t;)h&&h[v].run();v=-1,t=p.length}h=null,_=!1,i(e)}}function s(e,t){this.fun=e,this.array=t}function l(){}var c,f,d=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(e){c=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var h,p=[],_=!1,v=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new s(e,t)),1!==p.length||_||o(u)},s.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=l,d.addListener=l,d.once=l,d.off=l,d.removeListener=l,d.removeAllListeners=l,d.emit=l,d.prependListener=l,d.prependOnceListener=l,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Node.GomlNode},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Node.Attribute},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(10),s=function(e){return e&&e.__esModule?e:{default:e}}(u),l=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._morphBaseAttribute={},e.morphParameters={},e.lastWeights=null,e}return i(t,e),a(t,[{key:"addMorphAttribute",value:function(e,t){var n=this.accessors[e];if(!n)throw new Error("There was no accessor related to specified accessor");var r=this.buffers[n.bufferIndex];if(!r.keepSource)throw new Error("To enable morphing attribute on Geometry, keepOnBuffer flag must be true on attribute vertex value");if(this._morphBaseAttribute[e])throw new Error("Already morphing attribute are registered. If you want to replace, remove current morphings at first.");if(null===this.lastWeights){for(var o=[],i=0;i<t.length;i++)o.push(0);this.lastWeights=o}else if(this.lastWeights.length!==t.length)throw new Error("morphing attribute should have same length with the morphing attribute previously registered.");var a=r.bufferSource;if(!(a instanceof Float32Array))throw new Error("Morphing is currently only supported for Float32Array");for(var u=a.byteLength/a.BYTES_PER_ELEMENT,s=new Float32Array(u),l=0;l<u;l++)s[l]=a[l];this._morphBaseAttribute[e]={buffer:s,accessor:this.accessors[e]},this.morphParameters[e]=t}},{key:"removeMorphAttribute",value:function(e){delete this.morphParameters[e],delete this._morphBaseAttribute[e],0===Object.keys(this.morphParameters).length&&(this.lastWeights=null)}},{key:"setWeight",value:function(e){this.lastWeights=e;for(var t in this._morphBaseAttribute)this._updateForSemantics(t)}},{key:"_updateForSemantics",value:function(e){var t=this.accessors[e],n=this.buffers[t.bufferIndex],r=n.bufferSource;if(!(r instanceof Float32Array))throw new Error("buffer source must be Float32Array");for(var o=0;o<r.length;o++)r[o]=this._calculateWeights(e,o);n.update(r)}},{key:"_calculateWeights",value:function(e,t){for(var n=this._morphBaseAttribute[e].buffer[t],r=0;r<this.lastWeights.length;r++)n+=this.lastWeights[r]*this.morphParameters[e][r].buffer[t];return n}}]),t}(s.default);t.default=l},function(e,t){e.exports='@Technique default{\n@Pass{\n  @DynamicState(dynamic-cull)\n  @BlendFunc(SRC_ALPHA,ONE_MINUS_SRC_ALPHA)\n  FS_PREC(mediump,float)\n  @import "basic-vert"\n  #ifdef FS\n  @{type:"color",default:"white"}\n  uniform vec4 color;\n\n  @{flag:"USE_TEXTURE"}\n  uniform sampler2D texture;\n\n  uniform float _time;\n  void main(void)\n  {\n    vec4 baseColor = color;\n    #ifdef ATTRIBUTE_COLOR_ENABLED\n    baseColor *= vColor;\n    #endif\n    #ifdef USE_TEXTURE\n      gl_FragColor = baseColor * texture2D(texture,vTexCoord);\n    #endif\n    #ifndef USE_TEXTURE\n      gl_FragColor = baseColor;\n    #endif\n  }\n  #endif\n}\n}\n\n@Technique hitarea{\n  @Disable(BLEND)\n  @Pass{\n    FS_PREC(mediump,float)\n    @import "basic-vert"\n    #ifdef FS\n      @MESH_INDEX\n      uniform vec4 meshIndex;\n      void main(){\n        gl_FragColor = meshIndex;\n      }\n    #endif\n  }\n}\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(17),i=r(o),a=n(11),u=r(a);u.default.add("MODELVIEWPROJECTION",function(e){return function(t,n){if(!n.transform)return void t.uniformMatrix(e.name,i.default.identity());t.uniformMatrix(e.name,n.transform.calcPVM(n.camera))}}),u.default.add("LOCAL",function(e){return function(t,n){if(!n.transform)return void t.uniformMatrix(e.name,i.default.identity());t.uniformMatrix(e.name,n.transform.localTransform)}}),u.default.add("MODEL",function(e){return function(t,n){if(!n.transform)return void t.uniformMatrix(e.name,i.default.identity());t.uniformMatrix(e.name,n.transform.globalTransform)}}),u.default.add("MODELVIEW",function(e){return function(t,n){if(!n.transform)return void t.uniformMatrix(e.name,i.default.identity());t.uniformMatrix(e.name,n.camera.ViewMatrix.multiplyWith(n.transform.globalTransform))}}),u.default.add("VIEW",function(e){return function(t,n){if(!n.transform)return void t.uniformMatrix(e.name,i.default.identity());t.uniformMatrix(e.name,n.camera.ViewMatrix)}}),u.default.add("PROJECTION",function(e){return function(t,n){if(!n.transform)return void t.uniformMatrix(e.name,i.default.identity());t.uniformMatrix(e.name,n.camera.ProjectionMatrix)}}),u.default.add("MODELINVERSE",function(e){return function(t,n){if(!n.transform)return void t.uniformMatrix(e.name,i.default.identity());t.uniformMatrix(e.name,i.default.inverse(n.transform.globalTransform))}}),u.default.add("VIEWINVERSE",function(e){return function(t,n){t.uniformMatrix(e.name,i.default.inverse(n.camera.ViewMatrix))}}),u.default.add("PROJECTIONINVERSE",function(e){return function(t,n){if(!n.transform)return void t.uniformMatrix(e.name,i.default.identity());t.uniformMatrix(e.name,n.camera.InvProjectionMatrix)}}),u.default.add("MODELVIEWINVERSE",function(e){return function(t,n){if(!n.transform)return void t.uniformMatrix(e.name,i.default.identity());t.uniformMatrix(e.name,i.default.inverse(n.transform.calcVM(n.camera)))}}),u.default.add("MODELVIEWPROJECTIONINVERSE",function(e){return function(t,n){if(!n.transform)return void t.uniformMatrix(e.name,i.default.identity());t.uniformMatrix(e.name,i.default.inverse(n.transform.calcPVM(n.camera)))}}),u.default.add("MODELINVERSETRANSPOSE",function(e){return function(t,n){if(!n.transform)return void t.uniformMatrix(e.name,i.default.identity());t.uniformMatrix(e.name,i.default.transpose(i.default.inverse(n.transform.globalTransform)))}}),u.default.add("MODELVIEWINVERSETRANSPOSE",function(e){return function(t,n){if(!n.transform)return void t.uniformMatrix3(e.name,i.default.identity());t.uniformMatrix3(e.name,i.default.transpose(i.default.inverse(n.transform.calcVM(n.camera))))}}),t.default=null},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(133),i=r(o),a=n(18),u=r(a),s=n(46),l=r(s),c=n(11),f=r(c);f.default.add("VIEWPORT",function(e){return function(t,n){var r=n.viewport;t.uniformVector4(e.name,new u.default(r.Left,r.Top,r.Width,r.Height))}}),f.default.add("VIEWPORT_SIZE",function(e){return function(t,n){var r=n.viewport;t.uniformVector2(e.name,new i.default(r.Width,r.Height))}}),f.default.add("TIME",function(e){var t=e.attributes.unit||"ms",n=1;switch(t){case"s":n=1e3}return function(t,r){t.uniformFloat(e.name,Date.now()/n%1e5)}}),f.default.add("HAS_TEXTURE",function(e,t){var n=e.attributes.sampler;if(!n)throw new Error("The variable having HAS_TEXTURE as semantics must have sampler attribute");return console.warn("HAS_TEXTURE is deprecated now. Use flag attribute on sampler2D variables to register macro values"),function(r,o){var i=!!t.arguments[n]&&!!t.arguments[n].get();r.uniformBool(e.name,i)}}),f.default.add("CAMERA_POSITION",function(e){return function(t,n){t.uniformVector3(e.name,n.camera.transform.globalPosition)}}),f.default.add("CAMERA_DIRECTION",function(e){return function(t,n){t.uniformVector3(e.name,n.camera.transform.forward)}}),f.default.add("MESH_INDEX",function(e){return function(t,n){var r=n.renderable.index;t.uniformVector4(e.name,l.default.fromIndex(r))}}),f.default.add("MOUSE_POSITION",function(e){var t=e.attributes.coord||"viewportNormalized";return function(n,r){var o=r.rendererDescription.mouse;o?n.uniformVector2(e.name,new i.default(o.coords[t][0],o.coords[t][1])):n.uniformVector2(e.name,i.default.Zero)}}),f.default.add("MOUSE_STATE",function(e){return function(t,n){var r=n.rendererDescription.mouse;r?t.uniformVector2(e.name,new i.default(r.left?1:0,r.right?1:0)):t.uniformVector2(e.name,i.default.Zero)}}),t.default=null},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS&&window.GrimoireJS.lib.math?window.GrimoireJS.lib.math.Vector2:void 0},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n,r,o,i){var a=void 0;a=t?c.array:c.single,a[e]=function(e,t){t.addArgument(e.name,{converter:n,default:e.attributes.default?e.attributes.default:r});var a=i?function(t,n,r){i(e,t,n,r)}:void 0;return{register:function(n,r){o(n,e.name,t.arguments[e.name],r)},update:a}}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),a=r(i),u=n(11),s=r(u),l=WebGLRenderingContext,c={array:{},single:{}};s.default.add("USER_VALUE",function(e,t,n,r){var o=void 0;if(e.count){if(!(o=c.array[e.type]))throw new Error("No user_value registerer was registered for "+e.type+"[]")}else if(!(o=c.single[e.type]))throw new Error("No user_value registerer was registered for "+e.type);return o(e,t)}),o(l.FLOAT,!1,"Number",0,function(e,t,n){return e.uniformFloat(t,n)}),o(l.INT,!1,"Number",0,function(e,t,n){return e.uniformInt(t,n)}),o(l.BOOL,!1,"Boolean",!1,function(e,t,n){return e.uniformBool(t,n)}),o(l.INT_VEC2,!1,"Vector2",[0,0],function(e,t,n){return e.uniformVector2(t,n)}),o(l.INT_VEC3,!1,"Vector3",[0,0,0],function(e,t,n){return e.uniformVector3(t,n)}),o(l.INT_VEC4,!1,"Vector4",[0,0,0,0],function(e,t,n){return e.uniformVector4(t,n)}),o(l.FLOAT_VEC2,!1,"Vector2",[0,0],function(e,t,n){return e.uniformVector2(t,n)}),o(l.FLOAT_MAT4,!0,"Object",[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],function(e,t,n){return e.uniformMatrixArray(t,n)}),o(l.SAMPLER_2D,!1,"Texture",null,function(e,t,n,r){var o=void 0;if(n){var i=n.get();i.valid&&(o=i)}o||(o=a.default.defaultTextures.get(e.program.gl)),e.uniformTexture2D(t,o)},function(e,t,n,r){if(void 0!==e.attributes.flag){var o=!1;if(n)if(n.isFunctionalProxy)o=!0;else{var i=n.get({});i.valid?o=!0:i.validPromise.then(function(){t.setMacro(e.attributes.flag,!0),o=!0})}t.setMacro(e.attributes.flag,o)}}),c.single[l.FLOAT_VEC3]=function(e,t){var n="color"===e.attributes.type,r=e.attributes.default,o=r||(n?[1,1,1]:[0,0,0]);return t.addArgument(e.name,{converter:n?"Color3":"Vector3",default:o}),{register:n?function(n,r){n.uniformColor3(e.name,t.arguments[e.name])}:function(n,r){n.uniformVector3(e.name,t.arguments[e.name])}}},c.single[l.FLOAT_VEC4]=function(e,t){var n="color"===e.attributes.type,r=e.attributes.default,o=r||(n?[1,1,1,1]:[0,0,0,0]);return t.addArgument(e.name,{converter:n?"Color4":"Vector4",default:o}),{register:n?function(n,r){n.uniformColor4(e.name,t.arguments[e.name])}:function(n,r){n.uniformVector4(e.name,t.arguments[e.name])}}},t.default=null},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={goml:{components:["CanvasInitializer","LoopManager","AssetLoadingManager","GeometryRegistory","RendererManager","Fullscreen"]},scene:{components:["Scene"]},object:{components:["Transform"]},camera:{components:["Camera"],default:{position:[0,0,10]},super:"object"},mesh:{components:["MaterialContainer","MeshRenderer"],super:"object"},renderer:{components:["Renderer"]},geometry:{components:["Geometry"]},texture:{components:["Texture"]},material:{components:["Material"]},"import-material":{components:["MaterialImporter"]},"texture-buffer":{components:["TextureBuffer"]},"render-buffer":{components:["RenderBuffer"]},"render-scene":{components:["RenderScene","RenderHitArea"],default:{material:null}},"render-quad":{components:["MaterialContainer","RenderQuad"],default:{material:null}}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(97),i=r(o),a=n(106),u=r(a),s=n(107),l=r(s),c=n(112),f=r(c),d=n(114),h=r(d),p=n(20),_=r(p),v=n(5),y=r(v),b=n(34),m=r(b),g=n(15),w=r(g),E=n(52),R=r(E),O=n(55),T=r(O),C=n(85),x=r(C),P=n(86),M=r(P),S=n(87),k=r(S),A=n(16),j=r(A),L=n(39),I=r(L),N=n(22),G=r(N),F=n(89),D=r(F),B=n(90),W=r(B),U=n(91),V=r(U),H=n(23),z=r(H),q=n(93),X=r(q),$=n(94),Y=r($),J=n(99),Z=r(J),Q=n(47),K=r(Q),ee=n(19),te=r(ee),ne=n(100),re=r(ne),oe=n(44),ie=r(oe),ae=n(101),ue=r(ae),se=n(43),le=r(se),ce=n(13),fe=r(ce),de=n(102),he=r(de),pe=n(45),_e=r(pe),ve=n(8),ye=r(ve),be=n(103),me=r(be),ge=n(104),we=r(ge),Ee=n(105),Re=r(Ee),Oe=n(108),Te=r(Oe),Ce=n(109),xe=r(Ce),Pe=n(111),Me=r(Pe),Se=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})};t.default=function(){y.default.register(function(){return Se(void 0,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:y.default.registerComponent("AssetLoadingManager",m.default),y.default.registerComponent("Camera",R.default),y.default.registerComponent("CanvasInitializer",T.default),y.default.registerComponent("Fullscreen",x.default),y.default.registerComponent("Geometry",M.default),y.default.registerComponent("GeometryRegistory",k.default),y.default.registerComponent("LoopManager",j.default),y.default.registerComponent("Material",I.default),y.default.registerComponent("MaterialContainer",G.default),y.default.registerComponent("MaterialImporter",D.default),y.default.registerComponent("MeshRenderer",W.default),y.default.registerComponent("MouseCameraControl",V.default),y.default.registerComponent("RenderBufferUpdator",le.default),y.default.registerComponent("Renderer",z.default),y.default.registerComponent("RendererManager",X.default),y.default.registerComponent("RenderQuad",Z.default),y.default.registerComponent("RenderScene",K.default),y.default.registerComponent("Scene",te.default),y.default.registerComponent("ColorBufferTextureUpdator",re.default),y.default.registerComponent("TextureContainer",fe.default),y.default.registerComponent("Transform",ye.default),y.default.registerComponent("RenderHitArea",i.default),y.default.registerComponent("ImageTextureUpdator",ue.default),y.default.registerComponent("VideoTextureUpdator",he.default),y.default.registerComponent("ViewportSizeResourceResizer",_e.default),y.default.registerComponent("ConstantSizeResourceResizer",ie.default),y.default.registerComponent("RenderingTarget",Y.default),y.default.registerComponent("BasicComponent",w.default),y.default.registerConverter("CanvasSize",me.default),y.default.registerConverter("Geometry",we.default),y.default.registerConverter("Material",Re.default),y.default.registerConverter("Texture",xe.default),y.default.registerConverter("Texture2D",xe.default),y.default.registerConverter("Viewport",Me.default),y.default.registerConverter("Node",u.default),y.default.registerConverter(l.default),y.default.registerConverter("RenderingTarget",Te.default),y.default.registerNode("goml",["CanvasInitializer","LoopManager","AssetLoadingManager","GeometryRegistory","RendererManager","Fullscreen"]),y.default.registerNode("scene",["Scene"]),y.default.registerNode("object",["Transform"]),y.default.registerNode("camera",["Camera"],{position:"0,0,10"},"object"),y.default.registerNode("mesh",["MaterialContainer","MeshRenderer"],{},"object"),y.default.registerNode("renderer",["Renderer"]),y.default.registerNode("geometry",["Geometry"]),y.default.registerNode("texture",["TextureContainer"]),y.default.registerNode("image-texture",["ImageTextureUpdator"],{},"texture"),y.default.registerNode("video-texture",["VideoTextureUpdator"],{},"texture"),y.default.registerNode("material",["Material"]),y.default.registerNode("import-material",["MaterialImporter"]),y.default.registerNode("color-buffer",["ColorBufferTextureUpdator"],{resizerType:"ViewportSize"},"texture"),y.default.registerNode("render-buffer",["RenderBufferUpdator"],{resizerType:"ViewportSize"}),y.default.registerNode("render-scene",["RenderScene","RenderHitArea"],{material:null}),y.default.registerNode("render-quad",["MaterialContainer","RenderQuad"],{material:null}),y.default.registerNode("rendering-target",["RenderingTarget"]),f.default.register(),h.default.register(),_.default.request("OES_texture_float");case 57:case"end":return e.stop()}},e,this)}))})}}])});